<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Learning module 2 - Return intervals (14 pts) | Quantitative Environmental Methods: LRES 546</title>
  <meta name="description" content="Chapter 4 Learning module 2 - Return intervals (14 pts) | Quantitative Environmental Methods: LRES 546" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Learning module 2 - Return intervals (14 pts) | Quantitative Environmental Methods: LRES 546" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Learning module 2 - Return intervals (14 pts) | Quantitative Environmental Methods: LRES 546" />
  
  
  

<meta name="author" content="Tim Covino" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="hydrograph-separation-lab-module-20-pts.html"/>
<link rel="next" href="rational-method-and-nrcs-curve-number-14-pts.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">lres_546</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-overview-and-objectives"><i class="fa fa-check"></i><b>1.1</b> Course overview and objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i><b>1.2</b> Course Description</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i><b>1.3</b> Structure</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#philosophical-approach-and-resources"><i class="fa fa-check"></i><b>1.4</b> Philosophical approach and resources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#tentative-schedule-subject-to-change"><i class="fa fa-check"></i><b>1.5</b> Tentative schedule, subject to change</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html"><i class="fa fa-check"></i><b>2</b> Hydrograph separation: learning module</a>
<ul>
<li class="chapter" data-level="2.1" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#summary"><i class="fa fa-check"></i><b>2.1</b> Summary</a></li>
<li class="chapter" data-level="2.2" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#overall-learning-objectives"><i class="fa fa-check"></i><b>2.2</b> Overall Learning Objectives</a></li>
<li class="chapter" data-level="2.3" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#lecture"><i class="fa fa-check"></i><b>2.3</b> Lecture</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#components-of-streamflow-during-a-rain-event"><i class="fa fa-check"></i><b>2.3.1</b> Components of streamflow during a rain event</a></li>
<li class="chapter" data-level="2.3.2" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#storm-flow-through-a-hillslope"><i class="fa fa-check"></i><b>2.3.2</b> Storm flow through a hillslope</a></li>
<li class="chapter" data-level="2.3.3" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#how-we-quantify-baseflow"><i class="fa fa-check"></i><b>2.3.3</b> How we quantify baseflow</a></li>
<li class="chapter" data-level="2.3.4" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#baseflow-separation-methods"><i class="fa fa-check"></i><b>2.3.4</b> Baseflow separation methods</a></li>
<li class="chapter" data-level="2.3.5" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#watershed-controls-on-baseflow-and-stormflow"><i class="fa fa-check"></i><b>2.3.5</b> Watershed controls on baseflow and stormflow</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#assessment"><i class="fa fa-check"></i><b>2.4</b> Assessment</a></li>
<li class="chapter" data-level="2.5" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#interactive-application-and-questions"><i class="fa fa-check"></i><b>2.5</b> Interactive application and questions</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#initial-data-exploration"><i class="fa fa-check"></i><b>2.5.1</b> Initial data exploration</a></li>
<li class="chapter" data-level="2.5.2" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#synthesis-questions"><i class="fa fa-check"></i><b>2.5.2</b> Synthesis Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="hydrograph-separation-lab-module-20-pts.html"><a href="hydrograph-separation-lab-module-20-pts.html"><i class="fa fa-check"></i><b>3</b> Hydrograph separation: lab module (20 pts)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="hydrograph-separation-lab-module-20-pts.html"><a href="hydrograph-separation-lab-module-20-pts.html#intro"><i class="fa fa-check"></i><b>3.1</b> Intro</a></li>
<li class="chapter" data-level="3.2" data-path="hydrograph-separation-lab-module-20-pts.html"><a href="hydrograph-separation-lab-module-20-pts.html#reading-for-this-lab"><i class="fa fa-check"></i><b>3.2</b> Reading for this lab</a></li>
<li class="chapter" data-level="3.3" data-path="hydrograph-separation-lab-module-20-pts.html"><a href="hydrograph-separation-lab-module-20-pts.html#repo"><i class="fa fa-check"></i><b>3.3</b> Repo</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html"><i class="fa fa-check"></i><b>4</b> Learning module 2 - Return intervals (14 pts)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#background-information"><i class="fa fa-check"></i><b>4.1</b> Background information</a></li>
<li class="chapter" data-level="4.2" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#intro-1"><i class="fa fa-check"></i><b>4.2</b> Intro</a></li>
<li class="chapter" data-level="4.3" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#packages"><i class="fa fa-check"></i><b>4.3</b> Packages</a></li>
<li class="chapter" data-level="4.4" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#precipitation-return-intervals"><i class="fa fa-check"></i><b>4.4</b> Precipitation return intervals</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#q1.-2-pts-what-is-the-probability-that-the-annual-precipitation-in-a-given-year-is-less-than-400-mm-this-is-the-fa-in-the-cdf-in-the-probability-lecture-slides."><i class="fa fa-check"></i><b>4.4.1</b> <strong>Q1. (2 pts) What is the probability that the annual precipitation in a given year is less than 400 mm? This is the F(A) in the CDF in the probability lecture slides.</strong></a></li>
<li class="chapter" data-level="4.4.2" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#q2.-2-pts-what-is-the-probability-that-the-maximum-annual-precipitation-in-a-given-year-is-greater-than-500-mm"><i class="fa fa-check"></i><b>4.4.2</b> <strong>Q2. (2 pts) What is the probability that the maximum annual precipitation in a given year is GREATER than 500 mm?</strong></a></li>
<li class="chapter" data-level="4.4.3" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#q3.-2-pts-what-is-the-probability-that-the-annual-p-is-between-400-and-500-mm"><i class="fa fa-check"></i><b>4.4.3</b> <strong>Q3. (2 pts) What is the probability that the annual P is between 400 and 500 mm?</strong></a></li>
<li class="chapter" data-level="4.4.4" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#q4.-2-pts-what-is-the-return-period-for-a-year-with-at-least-550-mm-of-precip-the-return-period-tr-is-calculated-as-tr-1p-with-p-being-the-probability-for-an-event-to-occur."><i class="fa fa-check"></i><b>4.4.4</b> <strong>Q4. (2 pts) What is the return period for a year with AT LEAST 550 mm of precip? The return period, Tr, is calculated as Tr = 1/p, with p being the probability for an event to occur.</strong></a></li>
<li class="chapter" data-level="4.4.5" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#q5.-6-pts-explain-why-probability-analysis-of-climate-data-assumes-the-data-are-normally-distributed-and-stationary-below-provide-a-histogram-and-a-density-plot-of-the-total-annual-p-data-and-comment-on-the-visual-appearance-in-terms-of-normality.-next-use-google-and-the-links-below-to-test-for-normality-and-stationarity.-be-quantitative-in-commenting-on-the-normality-and-stationarity-of-the-total-p-data."><i class="fa fa-check"></i><b>4.4.5</b> <strong>Q5. (6 pts) Explain why probability analysis of climate data assumes the data are normally distributed and stationary? Below provide a histogram and a density plot of the total annual P data and comment on the visual appearance in terms of normality. Next use google and the links below to test for normality and stationarity. Be quantitative in commenting on the normality and stationarity of the total P data.</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html"><i class="fa fa-check"></i><b>5</b> Rational method and NRCS curve number (14 pts)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#rational-method"><i class="fa fa-check"></i><b>5.1</b> Rational Method</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#background-information-1"><i class="fa fa-check"></i><b>5.1.1</b> Background information</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#curve-number"><i class="fa fa-check"></i><b>5.2</b> Curve Number</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#background-information-2"><i class="fa fa-check"></i><b>5.2.1</b> Background information</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#codework"><i class="fa fa-check"></i><b>5.3</b> Codework</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#packages-1"><i class="fa fa-check"></i><b>5.3.1</b> Packages</a></li>
<li class="chapter" data-level="5.3.2" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#part-i---rational-method"><i class="fa fa-check"></i><b>5.3.2</b> Part I - Rational Method</a></li>
<li class="chapter" data-level="5.3.3" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#part-ii---nrcs-cn"><i class="fa fa-check"></i><b>5.3.3</b> Part II - NRCS CN</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html"><i class="fa fa-check"></i><b>6</b> 6 Transfer function rainfall-runoff models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#summary-1"><i class="fa fa-check"></i><b>6.1</b> 6.1 Summary</a></li>
<li class="chapter" data-level="6.2" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#overall-learning-objectives-1"><i class="fa fa-check"></i><b>6.2</b> 6.2 Overall Learning Objectives</a></li>
<li class="chapter" data-level="6.3" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#terminology"><i class="fa fa-check"></i><b>6.3</b> 6.3 Terminology</a></li>
<li class="chapter" data-level="6.4" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#the-linear-time-invariant-tf"><i class="fa fa-check"></i><b>6.4</b> 6.4 The Linear Time-Invariant TF</a></li>
<li class="chapter" data-level="6.5" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#codework---transfer-function-rainfall-runoff-model"><i class="fa fa-check"></i><b>6.5</b> 6.6 Codework - Transfer function rainfall-runoff model</a></li>
<li class="chapter" data-level="6.6" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#repo-1"><i class="fa fa-check"></i><b>6.6</b> Repo:</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html"><i class="fa fa-check"></i><b>7</b> 7. Monte Carlo Simulation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#background"><i class="fa fa-check"></i><b>7.1</b> 7.1 Background:</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#reading"><i class="fa fa-check"></i><b>7.1.1</b> 7.1.1 - Reading</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#how-does-this-apply-to-hydrological-modeling"><i class="fa fa-check"></i><b>7.2</b> 7.2 How does this apply to hydrological modeling?</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#example"><i class="fa fa-check"></i><b>7.2.1</b> 7.2.1 Example</a></li>
<li class="chapter" data-level="7.2.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#reading-1"><i class="fa fa-check"></i><b>7.2.2</b> 7.2.2 - Reading</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#how-do-we-generate-a-simulation-with-code"><i class="fa fa-check"></i><b>7.3</b> 7.3 How do we generate a simulation with code?</a></li>
<li class="chapter" data-level="7.4" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#assignment"><i class="fa fa-check"></i><b>7.4</b> 7.4 Assignment</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#setup"><i class="fa fa-check"></i><b>7.4.1</b> 7.4.1 Setup</a></li>
<li class="chapter" data-level="7.4.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#parameter-initialization"><i class="fa fa-check"></i><b>7.4.2</b> 7.4.2 Parameter initialization</a></li>
<li class="chapter" data-level="7.4.3" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#mc-model-run"><i class="fa fa-check"></i><b>7.4.3</b> 7.4.3 MC Model run</a></li>
<li class="chapter" data-level="7.4.4" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#sensitivity-analysis"><i class="fa fa-check"></i><b>7.4.4</b> 7.4.4 Sensitivity analysis</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Environmental Methods: LRES 546</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="learning-module-2---return-intervals-14-pts" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Learning module 2 - Return intervals (14 pts)<a href="learning-module-2---return-intervals-14-pts.html#learning-module-2---return-intervals-14-pts" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<ul>
<li>In this learning module we will focus on return intervals. We first need to understand return intervals before we can move onto the rational method and curve numbers.</li>
</ul>
<p>The repo for this module can be found <a href="https://github.com/tpcovino/02_return_intervals.git" target="_blank">here</a></p>
<div id="background-information" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Background information<a href="learning-module-2---return-intervals-14-pts.html#background-information" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Lecture from colleague Joel Sholtes on precipitation frequency analysis.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3_EnTJaFCKg?si=1BYvBzA1fDjZK4Zv" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen>
</iframe>
<p>Short lecture on Intensity-Duration-Frequency (IDF) curves</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/JXSwKmfMZJo?si=nlHa4Th3ZCSzi2Ks" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen>
</iframe>
<p>Reading on frequency analysis of flow (e.g., floods). You should notice that the frequency analysis is the same whether we apply it to Q (flow) or P (precipitation). So as long as you understand the fundamental principles you will be able to do frequency analysis on either Q or P.</p>
<p><a href="https://www.usgs.gov/centers/new-jersey-water-science-center/floods-recurrence-intervals-and-100-year-floods" target="_blank">USGS reading on flow frequency analysis</a></p>
<p>There are also probability lecture slides on D2L. Titled “probability.pptx”.</p>
</div>
<div id="intro-1" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Intro<a href="learning-module-2---return-intervals-14-pts.html#intro-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this lab we will look at some precipitation data to get an idea of return intervals for a given rain event. A return interval is the inverse of the probability. So if a certain rain even has a 10% probability of happening any year it has a 1/p return interval, so: R = 1/0.1 = 10 years. This means on average you can expect that size event about every ten years. From a probability perspective it is actually more correct to state that there is a 10% chance of that size rain event in any year. The reason this is better is that it communicates that you certainly can have a 10% probability event occur in back-to-back years.</p>
<p>After computing some return intervals we will then use some of the simpler rainfall-runoff modeling approaches (the rational method and the curve number method) to simulate runoff for a hypothetical basin in our next unit.</p>
<p>This is knitr settings. Knitr is a package that will turn this Rmd to an html.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="learning-module-2---return-intervals-14-pts.html#cb1-1" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, <span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>, <span class="at">results =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="packages" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Packages<a href="learning-module-2---return-intervals-14-pts.html#packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have a few new packages today. Those include rnoaa and leaflet. rnooa is a package used to download NOAA climate data. leaflet is a package for interactive mapping.</p>
<p>Recall that if you have not installed these packages on your computer you will need to run:</p>
<p>install.packages(“rnoaa”) and so on for the others.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="learning-module-2---return-intervals-14-pts.html#cb2-1" tabindex="-1"></a><span class="co"># library(tidyverse)</span></span>
<span id="cb2-2"><a href="learning-module-2---return-intervals-14-pts.html#cb2-2" tabindex="-1"></a><span class="co"># library(rnoaa) #this package is being deprecated, unfortunately. But should work for now. </span></span>
<span id="cb2-3"><a href="learning-module-2---return-intervals-14-pts.html#cb2-3" tabindex="-1"></a><span class="co"># library(plotly)</span></span>
<span id="cb2-4"><a href="learning-module-2---return-intervals-14-pts.html#cb2-4" tabindex="-1"></a><span class="co"># library(leaflet)</span></span>
<span id="cb2-5"><a href="learning-module-2---return-intervals-14-pts.html#cb2-5" tabindex="-1"></a><span class="co"># library(lubridate)</span></span></code></pre></div>
</div>
<div id="precipitation-return-intervals" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Precipitation return intervals<a href="learning-module-2---return-intervals-14-pts.html#precipitation-return-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, let’s start by getting some precipitation (P) data. rnoaa has a function called ghcnd_stations(). This function will download the site information for all stations in the GHCND network.</p>
<p>GHCND network
- <a href="https://www.ncei.noaa.gov/products/land-based-station/global-historical-climatology-network-daily" target="_blank">Link</a></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="learning-module-2---return-intervals-14-pts.html#cb3-1" tabindex="-1"></a><span class="co"># # download all available station metadata</span></span>
<span id="cb3-2"><a href="learning-module-2---return-intervals-14-pts.html#cb3-2" tabindex="-1"></a><span class="co"># # THIS CAN TAKE A WHILE! I&#39;d suggest to run it only once and then comment it out with #.</span></span>
<span id="cb3-3"><a href="learning-module-2---return-intervals-14-pts.html#cb3-3" tabindex="-1"></a><span class="co"># station_data_download &lt;- ghcnd_stations()  </span></span>
<span id="cb3-4"><a href="learning-module-2---return-intervals-14-pts.html#cb3-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-5"><a href="learning-module-2---return-intervals-14-pts.html#cb3-5" tabindex="-1"></a><span class="co"># # filter to only keep MT stations</span></span>
<span id="cb3-6"><a href="learning-module-2---return-intervals-14-pts.html#cb3-6" tabindex="-1"></a><span class="co"># station_data &lt;- station_data_download %&gt;% </span></span>
<span id="cb3-7"><a href="learning-module-2---return-intervals-14-pts.html#cb3-7" tabindex="-1"></a><span class="co">#   filter(state == &quot;BLANK&quot;)</span></span>
<span id="cb3-8"><a href="learning-module-2---return-intervals-14-pts.html#cb3-8" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-9"><a href="learning-module-2---return-intervals-14-pts.html#cb3-9" tabindex="-1"></a><span class="co"># # that&#39;s still a lot of stations. Let thin for &quot;BOZEMAN&quot;</span></span>
<span id="cb3-10"><a href="learning-module-2---return-intervals-14-pts.html#cb3-10" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-11"><a href="learning-module-2---return-intervals-14-pts.html#cb3-11" tabindex="-1"></a><span class="co"># station_data_bzn &lt;- station_data %&gt;% </span></span>
<span id="cb3-12"><a href="learning-module-2---return-intervals-14-pts.html#cb3-12" tabindex="-1"></a><span class="co">#   filter(str_detect(name, &quot;BLANK&quot;)) %&gt;% </span></span>
<span id="cb3-13"><a href="learning-module-2---return-intervals-14-pts.html#cb3-13" tabindex="-1"></a><span class="co">#   # get rid of duplicate ids to make plotting easier</span></span>
<span id="cb3-14"><a href="learning-module-2---return-intervals-14-pts.html#cb3-14" tabindex="-1"></a><span class="co">#   dplyr::distinct(id, .keep_all = TRUE)</span></span>
<span id="cb3-15"><a href="learning-module-2---return-intervals-14-pts.html#cb3-15" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-16"><a href="learning-module-2---return-intervals-14-pts.html#cb3-16" tabindex="-1"></a><span class="co"># # Now, let&#39;s create a zoomable map with the stations around Gallatin County/Bozeman. Click around and find the station id for the precip gauge with the LONGEST timeseries. If you click on a station symbol, the first and last data year will appear. Obviously you can get this information from the station_data_gal data frame, but I wanted to show you the mapping capabilities. </span></span>
<span id="cb3-17"><a href="learning-module-2---return-intervals-14-pts.html#cb3-17" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-18"><a href="learning-module-2---return-intervals-14-pts.html#cb3-18" tabindex="-1"></a><span class="co"># gauge_map &lt;- leaflet() %&gt;% </span></span>
<span id="cb3-19"><a href="learning-module-2---return-intervals-14-pts.html#cb3-19" tabindex="-1"></a><span class="co">#     # add a basemap</span></span>
<span id="cb3-20"><a href="learning-module-2---return-intervals-14-pts.html#cb3-20" tabindex="-1"></a><span class="co">#   addTiles() %&gt;%</span></span>
<span id="cb3-21"><a href="learning-module-2---return-intervals-14-pts.html#cb3-21" tabindex="-1"></a><span class="co">#     # add markers for your station. The parameters are pretty self-explanatory</span></span>
<span id="cb3-22"><a href="learning-module-2---return-intervals-14-pts.html#cb3-22" tabindex="-1"></a><span class="co">#   addAwesomeMarkers(data = station_data_bzn, lat = ~latitude, lng = ~longitude, label = ~id, popup = ~paste(&quot;Start date:&quot;, first_year, &quot;&lt;br&gt;End date:&quot;, last_year))</span></span>
<span id="cb3-23"><a href="learning-module-2---return-intervals-14-pts.html#cb3-23" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb3-24"><a href="learning-module-2---return-intervals-14-pts.html#cb3-24" tabindex="-1"></a><span class="co"># gauge_map</span></span></code></pre></div>
<p>Ok, so we want station USC00241044, which runs from 1892 to now. We use the meteo_pull_monitors() function to do that.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="learning-module-2---return-intervals-14-pts.html#cb4-1" tabindex="-1"></a><span class="co"># climate_data &lt;-   meteo_pull_monitors(c(&quot;BLANK&quot;),</span></span>
<span id="cb4-2"><a href="learning-module-2---return-intervals-14-pts.html#cb4-2" tabindex="-1"></a><span class="co"># # precip, snow, min air temp, max air temp (we really won&#39;t use the temp and snow data, though, this is only to show you what else would be available)</span></span>
<span id="cb4-3"><a href="learning-module-2---return-intervals-14-pts.html#cb4-3" tabindex="-1"></a><span class="co">#                       var = c(&quot;PRCP&quot;, &quot;SNOW&quot;, &quot;TMIN&quot;, &quot;TMAX&quot;),</span></span>
<span id="cb4-4"><a href="learning-module-2---return-intervals-14-pts.html#cb4-4" tabindex="-1"></a><span class="co">#                       date_min = &quot;1893-10-01&quot;,</span></span>
<span id="cb4-5"><a href="learning-module-2---return-intervals-14-pts.html#cb4-5" tabindex="-1"></a><span class="co">#                       # set end date to September 30, 2022</span></span>
<span id="cb4-6"><a href="learning-module-2---return-intervals-14-pts.html#cb4-6" tabindex="-1"></a><span class="co">#                       date_max = &quot;2022-09-30&quot;)</span></span></code></pre></div>
<p>Now we have some climate data. Take a minute to look at the climate_data df. First, just looking at the df we see that the data don’t actually start until 1894. It is also always a good idea to just plot some data. Below plot prcp, snow, tmax and tmin. You can just make 4 different plots. This is just for visual inspection. This part of the process is called exploratory data analysis (EDA). This should always be the first step when downloading data whether you download the data from the internet or from a sensor in the field.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="learning-module-2---return-intervals-14-pts.html#cb5-1" tabindex="-1"></a><span class="co"># climate_data %&gt;% </span></span>
<span id="cb5-2"><a href="learning-module-2---return-intervals-14-pts.html#cb5-2" tabindex="-1"></a><span class="co">#   ggplot(aes(x = date, y = prcp)) +</span></span>
<span id="cb5-3"><a href="learning-module-2---return-intervals-14-pts.html#cb5-3" tabindex="-1"></a><span class="co">#   geom_point()</span></span></code></pre></div>
<p>You might have noticed that the values seem to be much too large! Did you notice that? This is a great skill to develop. Have a look at the data and ask “are these numbers reasonable?”. In this case, the answer would be no!</p>
<p>One thing to note is that NOAA data comes in tenths of degrees for temp and tenths of millimeters for precip. Type ?meteo_pull_monitors into the console and the help screen will tell you that. So, we need to clean up the df a bit. Let’s do that here.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="learning-module-2---return-intervals-14-pts.html#cb6-1" tabindex="-1"></a><span class="co"># climate_data_corr &lt;- climate_data %&gt;% </span></span>
<span id="cb6-2"><a href="learning-module-2---return-intervals-14-pts.html#cb6-2" tabindex="-1"></a><span class="co">#   mutate(</span></span>
<span id="cb6-3"><a href="learning-module-2---return-intervals-14-pts.html#cb6-3" tabindex="-1"></a><span class="co">#     # change names</span></span>
<span id="cb6-4"><a href="learning-module-2---return-intervals-14-pts.html#cb6-4" tabindex="-1"></a><span class="co">#     name = recode(id, USC00241044</span></span>
<span id="cb6-5"><a href="learning-module-2---return-intervals-14-pts.html#cb6-5" tabindex="-1"></a><span class="co">#                   = &quot;msu_campus&quot;),</span></span>
<span id="cb6-6"><a href="learning-module-2---return-intervals-14-pts.html#cb6-6" tabindex="-1"></a><span class="co">#     # division by 10 turns it into a normal decimal, 15.6 instead of 156</span></span>
<span id="cb6-7"><a href="learning-module-2---return-intervals-14-pts.html#cb6-7" tabindex="-1"></a><span class="co">#     tmin = tmin / 10,</span></span>
<span id="cb6-8"><a href="learning-module-2---return-intervals-14-pts.html#cb6-8" tabindex="-1"></a><span class="co">#     tmax = tmax / 10,</span></span>
<span id="cb6-9"><a href="learning-module-2---return-intervals-14-pts.html#cb6-9" tabindex="-1"></a><span class="co">#     prcp = prcp / 10,</span></span>
<span id="cb6-10"><a href="learning-module-2---return-intervals-14-pts.html#cb6-10" tabindex="-1"></a><span class="co">#     snow = snow / 10) %&gt;%</span></span>
<span id="cb6-11"><a href="learning-module-2---return-intervals-14-pts.html#cb6-11" tabindex="-1"></a><span class="co">#   # only take important stuff</span></span>
<span id="cb6-12"><a href="learning-module-2---return-intervals-14-pts.html#cb6-12" tabindex="-1"></a><span class="co">#   select(name, id, everything())</span></span></code></pre></div>
<p>Now that we’ve converted units, it is a good idea to plot your data again for some EDA. Make plots of each of the variables (prcp, snow, tmax, and tmin) over time to inspect.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="learning-module-2---return-intervals-14-pts.html#cb7-1" tabindex="-1"></a><span class="co"># ggplotly(</span></span>
<span id="cb7-2"><a href="learning-module-2---return-intervals-14-pts.html#cb7-2" tabindex="-1"></a><span class="co">#   climate_data_corr %&gt;% </span></span>
<span id="cb7-3"><a href="learning-module-2---return-intervals-14-pts.html#cb7-3" tabindex="-1"></a><span class="co">#   ggplot(aes(x = date, y = prcp)) +</span></span>
<span id="cb7-4"><a href="learning-module-2---return-intervals-14-pts.html#cb7-4" tabindex="-1"></a><span class="co">#     geom_point() +</span></span>
<span id="cb7-5"><a href="learning-module-2---return-intervals-14-pts.html#cb7-5" tabindex="-1"></a><span class="co">#   geom_line(linetype = &quot;dashed&quot;)</span></span>
<span id="cb7-6"><a href="learning-module-2---return-intervals-14-pts.html#cb7-6" tabindex="-1"></a><span class="co"># ) # I commented this out just because plotly is slow. </span></span>
<span id="cb7-7"><a href="learning-module-2---return-intervals-14-pts.html#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="learning-module-2---return-intervals-14-pts.html#cb7-8" tabindex="-1"></a><span class="co"># climate_data_corr %&gt;% </span></span>
<span id="cb7-9"><a href="learning-module-2---return-intervals-14-pts.html#cb7-9" tabindex="-1"></a><span class="co">#   ggplot(aes(x = date, y = snow)) +</span></span>
<span id="cb7-10"><a href="learning-module-2---return-intervals-14-pts.html#cb7-10" tabindex="-1"></a><span class="co">#   geom_point()</span></span></code></pre></div>
<p>How do the data look? Do they make sense? Do you see any strange values?</p>
<p>There is a large snow event in 1951. We can assume that is “real”, so let’s keep it in the analysis. But you should think through how you could exclude it from the analysis. How could you use the filter function to do that?</p>
<p>Next, we want to use some skills from the hydrograph sep lab to add a water year (WY) column. Try that here.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="learning-module-2---return-intervals-14-pts.html#cb8-1" tabindex="-1"></a><span class="co"># climate_data_corr &lt;- climate_data_corr %&gt;% </span></span>
<span id="cb8-2"><a href="learning-module-2---return-intervals-14-pts.html#cb8-2" tabindex="-1"></a><span class="co">#   mutate(month = month(date),</span></span>
<span id="cb8-3"><a href="learning-module-2---return-intervals-14-pts.html#cb8-3" tabindex="-1"></a><span class="co">#          year = year(date),</span></span>
<span id="cb8-4"><a href="learning-module-2---return-intervals-14-pts.html#cb8-4" tabindex="-1"></a><span class="co">#          wy = BLANK(month &gt; 9, year + 1, year))</span></span></code></pre></div>
<p>I like to rearrange the order of columns. Using:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="learning-module-2---return-intervals-14-pts.html#cb9-1" tabindex="-1"></a><span class="co"># climate_data_corr &lt;- climate_data_corr %&gt;% </span></span>
<span id="cb9-2"><a href="learning-module-2---return-intervals-14-pts.html#cb9-2" tabindex="-1"></a><span class="co">#   select(name, id, date, wy, everything())</span></span></code></pre></div>
<p>Now, create a new df called climate_an where you calculate the total P (i.e., the sum) for each water year. Use group_by and summarize (or better yet, reframe). Also keep in mind that you will need to deal with NA values in the df. How do you do that in summarize? As a note, reframe can be used instead of summarize and is a more general purpose function. You can try each.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="learning-module-2---return-intervals-14-pts.html#cb10-1" tabindex="-1"></a><span class="co"># climate_an &lt;- climate_data_corr %&gt;% </span></span>
<span id="cb10-2"><a href="learning-module-2---return-intervals-14-pts.html#cb10-2" tabindex="-1"></a><span class="co">#   group_by(wy) %&gt;% </span></span>
<span id="cb10-3"><a href="learning-module-2---return-intervals-14-pts.html#cb10-3" tabindex="-1"></a><span class="co">#   BLANK(tot_p = sum(prcp,  BLANK), </span></span>
<span id="cb10-4"><a href="learning-module-2---return-intervals-14-pts.html#cb10-4" tabindex="-1"></a><span class="co">#             mean_max = mean(tmax, BLANK), </span></span>
<span id="cb10-5"><a href="learning-module-2---return-intervals-14-pts.html#cb10-5" tabindex="-1"></a><span class="co">#             mean_min = min(tmin, BLANK)) # I also calculate some temp stats here. Just out of curiosity. We don&#39;t use them in this lab. </span></span></code></pre></div>
<p>What happens if you don’t deal with NA values by using something like na.rm = TRUE?</p>
<p>Now, plot total anual P on the Y and water year on the x. What do you see?</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="learning-module-2---return-intervals-14-pts.html#cb11-1" tabindex="-1"></a><span class="co"># climate_an %&gt;% </span></span>
<span id="cb11-2"><a href="learning-module-2---return-intervals-14-pts.html#cb11-2" tabindex="-1"></a><span class="co">#   ggplot(aes(x = wy, y = tot_p)) +</span></span>
<span id="cb11-3"><a href="learning-module-2---return-intervals-14-pts.html#cb11-3" tabindex="-1"></a><span class="co">#   geom_point() +</span></span>
<span id="cb11-4"><a href="learning-module-2---return-intervals-14-pts.html#cb11-4" tabindex="-1"></a><span class="co">#   geom_line(linetype = &quot;dashed&quot;, color = &quot;blue&quot;)</span></span></code></pre></div>
<p>Now let’s calculate some probabilities. Look up the <code>pnorm()</code> function for this (either type it into the Help window, or type ?pnorm in the console. You only need x, the mean, and standard deviation (sd) for the calculations.</p>
<div id="q1.-2-pts-what-is-the-probability-that-the-annual-precipitation-in-a-given-year-is-less-than-400-mm-this-is-the-fa-in-the-cdf-in-the-probability-lecture-slides." class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> <strong>Q1. (2 pts) What is the probability that the annual precipitation in a given year is less than 400 mm? This is the F(A) in the CDF in the probability lecture slides.</strong><a href="learning-module-2---return-intervals-14-pts.html#q1.-2-pts-what-is-the-probability-that-the-annual-precipitation-in-a-given-year-is-less-than-400-mm-this-is-the-fa-in-the-cdf-in-the-probability-lecture-slides." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="learning-module-2---return-intervals-14-pts.html#cb12-1" tabindex="-1"></a><span class="co"># p_400 &lt;- pnorm(400, mean(climate_an$tot_p), sd(climate_an$tot_p))</span></span>
<span id="cb12-2"><a href="learning-module-2---return-intervals-14-pts.html#cb12-2" tabindex="-1"></a><span class="co"># p_400</span></span></code></pre></div>
<p>Q1 ANSWER:</p>
</div>
<div id="q2.-2-pts-what-is-the-probability-that-the-maximum-annual-precipitation-in-a-given-year-is-greater-than-500-mm" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> <strong>Q2. (2 pts) What is the probability that the maximum annual precipitation in a given year is GREATER than 500 mm?</strong><a href="learning-module-2---return-intervals-14-pts.html#q2.-2-pts-what-is-the-probability-that-the-maximum-annual-precipitation-in-a-given-year-is-greater-than-500-mm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="learning-module-2---return-intervals-14-pts.html#cb13-1" tabindex="-1"></a><span class="co"># p_500 &lt;- pnorm(500, mean(climate_an$tot_p), sd(climate_an$tot_p))</span></span>
<span id="cb13-2"><a href="learning-module-2---return-intervals-14-pts.html#cb13-2" tabindex="-1"></a><span class="co"># ex_500 &lt;- 1 - p_500</span></span>
<span id="cb13-3"><a href="learning-module-2---return-intervals-14-pts.html#cb13-3" tabindex="-1"></a><span class="co"># ex_500</span></span></code></pre></div>
<p>Q2 ANSWER:</p>
</div>
<div id="q3.-2-pts-what-is-the-probability-that-the-annual-p-is-between-400-and-500-mm" class="section level3 hasAnchor" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> <strong>Q3. (2 pts) What is the probability that the annual P is between 400 and 500 mm?</strong><a href="learning-module-2---return-intervals-14-pts.html#q3.-2-pts-what-is-the-probability-that-the-annual-p-is-between-400-and-500-mm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="learning-module-2---return-intervals-14-pts.html#cb14-1" tabindex="-1"></a><span class="co"># p_500_400 &lt;- p_500 - p_400</span></span>
<span id="cb14-2"><a href="learning-module-2---return-intervals-14-pts.html#cb14-2" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb14-3"><a href="learning-module-2---return-intervals-14-pts.html#cb14-3" tabindex="-1"></a><span class="co"># p_500_400</span></span></code></pre></div>
</div>
<div id="q4.-2-pts-what-is-the-return-period-for-a-year-with-at-least-550-mm-of-precip-the-return-period-tr-is-calculated-as-tr-1p-with-p-being-the-probability-for-an-event-to-occur." class="section level3 hasAnchor" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> <strong>Q4. (2 pts) What is the return period for a year with AT LEAST 550 mm of precip? The return period, Tr, is calculated as Tr = 1/p, with p being the probability for an event to occur.</strong><a href="learning-module-2---return-intervals-14-pts.html#q4.-2-pts-what-is-the-return-period-for-a-year-with-at-least-550-mm-of-precip-the-return-period-tr-is-calculated-as-tr-1p-with-p-being-the-probability-for-an-event-to-occur." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="learning-module-2---return-intervals-14-pts.html#cb15-1" tabindex="-1"></a><span class="co"># p_550 &lt;- pnorm(550, mean(climate_an$tot_p), sd(climate_an$tot_p))</span></span>
<span id="cb15-2"><a href="learning-module-2---return-intervals-14-pts.html#cb15-2" tabindex="-1"></a><span class="co"># ex_550 &lt;- 1 - p_550</span></span>
<span id="cb15-3"><a href="learning-module-2---return-intervals-14-pts.html#cb15-3" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb15-4"><a href="learning-module-2---return-intervals-14-pts.html#cb15-4" tabindex="-1"></a><span class="co"># ri &lt;- 1/ex_550</span></span>
<span id="cb15-5"><a href="learning-module-2---return-intervals-14-pts.html#cb15-5" tabindex="-1"></a><span class="co"># ri</span></span></code></pre></div>
</div>
<div id="q5.-6-pts-explain-why-probability-analysis-of-climate-data-assumes-the-data-are-normally-distributed-and-stationary-below-provide-a-histogram-and-a-density-plot-of-the-total-annual-p-data-and-comment-on-the-visual-appearance-in-terms-of-normality.-next-use-google-and-the-links-below-to-test-for-normality-and-stationarity.-be-quantitative-in-commenting-on-the-normality-and-stationarity-of-the-total-p-data." class="section level3 hasAnchor" number="4.4.5">
<h3><span class="header-section-number">4.4.5</span> <strong>Q5. (6 pts) Explain why probability analysis of climate data assumes the data are normally distributed and stationary? Below provide a histogram and a density plot of the total annual P data and comment on the visual appearance in terms of normality. Next use google and the links below to test for normality and stationarity. Be quantitative in commenting on the normality and stationarity of the total P data.</strong><a href="learning-module-2---return-intervals-14-pts.html#q5.-6-pts-explain-why-probability-analysis-of-climate-data-assumes-the-data-are-normally-distributed-and-stationary-below-provide-a-histogram-and-a-density-plot-of-the-total-annual-p-data-and-comment-on-the-visual-appearance-in-terms-of-normality.-next-use-google-and-the-links-below-to-test-for-normality-and-stationarity.-be-quantitative-in-commenting-on-the-normality-and-stationarity-of-the-total-p-data." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><a href="https://rpubs.com/richkt/269797" target="_blank">here</a></p></li>
<li><p><a href="https://www.statology.org/kpss-test-in-r/" target="_blank">here</a></p></li>
<li><p><a href="http://www.sthda.com/english/wiki/normality-test-in-r" target="_blank">here</a></p></li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="learning-module-2---return-intervals-14-pts.html#cb16-1" tabindex="-1"></a><span class="co">#shapiro.test(climate_an$tot_p)</span></span>
<span id="cb16-2"><a href="learning-module-2---return-intervals-14-pts.html#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="learning-module-2---return-intervals-14-pts.html#cb16-3" tabindex="-1"></a><span class="co">#lag.length = 25</span></span>
<span id="cb16-4"><a href="learning-module-2---return-intervals-14-pts.html#cb16-4" tabindex="-1"></a><span class="co">#Box.test(climate_an$tot_p, lag = lag.length, type = &quot;Ljung-Box&quot;) # test stationary signal</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="learning-module-2---return-intervals-14-pts.html#cb17-1" tabindex="-1"></a><span class="co"># climate_an %&gt;% </span></span>
<span id="cb17-2"><a href="learning-module-2---return-intervals-14-pts.html#cb17-2" tabindex="-1"></a><span class="co">#   ggplot(aes(x = tot_p)) +</span></span>
<span id="cb17-3"><a href="learning-module-2---return-intervals-14-pts.html#cb17-3" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb17-4"><a href="learning-module-2---return-intervals-14-pts.html#cb17-4" tabindex="-1"></a><span class="co">#   geom_histogram(binwidth = 20, aes(y = after_stat(density)), colour = &quot;black&quot;, fill = &quot;gray&quot;) + # histogram</span></span>
<span id="cb17-5"><a href="learning-module-2---return-intervals-14-pts.html#cb17-5" tabindex="-1"></a><span class="co">#   geom_density(alpha = 0.2, fill = &quot;red&quot;) # density plot</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="hydrograph-separation-lab-module-20-pts.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rational-method-and-nrcs-curve-number-14-pts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tpcovino/lres_546_bookdown/edit/main/04_return_intervals.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/tpcovino/lres_546_bookdown/blob/main/04_return_intervals.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
