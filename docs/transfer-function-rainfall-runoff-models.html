<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Transfer function rainfall-runoff models | Quantitative Environmental Methods: LRES 546</title>
  <meta name="description" content="Chapter 6 Transfer function rainfall-runoff models | Quantitative Environmental Methods: LRES 546" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Transfer function rainfall-runoff models | Quantitative Environmental Methods: LRES 546" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Transfer function rainfall-runoff models | Quantitative Environmental Methods: LRES 546" />
  
  
  

<meta name="author" content="Tim Covino" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rational-method-and-nrcs-curve-number-14-pts.html"/>
<link rel="next" href="codework---transfer-function-rainfall-runoff-model.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">lres_546</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-overview-and-objectives"><i class="fa fa-check"></i><b>1.1</b> Course overview and objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i><b>1.2</b> Course Description</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i><b>1.3</b> Structure</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#philosophical-approach-and-resources"><i class="fa fa-check"></i><b>1.4</b> Philosophical approach and resources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#tentative-schedule-subject-to-change"><i class="fa fa-check"></i><b>1.5</b> Tentative schedule, subject to change</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html"><i class="fa fa-check"></i><b>2</b> Hydrograph separation: learning module</a>
<ul>
<li class="chapter" data-level="2.1" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#summary"><i class="fa fa-check"></i><b>2.1</b> Summary</a></li>
<li class="chapter" data-level="2.2" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#overall-learning-objectives"><i class="fa fa-check"></i><b>2.2</b> Overall Learning Objectives</a></li>
<li class="chapter" data-level="2.3" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#lecture"><i class="fa fa-check"></i><b>2.3</b> Lecture</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#components-of-streamflow-during-a-rain-event"><i class="fa fa-check"></i><b>2.3.1</b> Components of streamflow during a rain event</a></li>
<li class="chapter" data-level="2.3.2" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#storm-flow-through-a-hillslope"><i class="fa fa-check"></i><b>2.3.2</b> Storm flow through a hillslope</a></li>
<li class="chapter" data-level="2.3.3" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#how-we-quantify-baseflow"><i class="fa fa-check"></i><b>2.3.3</b> How we quantify baseflow</a></li>
<li class="chapter" data-level="2.3.4" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#baseflow-separation-methods"><i class="fa fa-check"></i><b>2.3.4</b> Baseflow separation methods</a></li>
<li class="chapter" data-level="2.3.5" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#watershed-controls-on-baseflow-and-stormflow"><i class="fa fa-check"></i><b>2.3.5</b> Watershed controls on baseflow and stormflow</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#assessment"><i class="fa fa-check"></i><b>2.4</b> Assessment</a></li>
<li class="chapter" data-level="2.5" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#interactive-application-and-questions"><i class="fa fa-check"></i><b>2.5</b> Interactive application and questions</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#initial-data-exploration"><i class="fa fa-check"></i><b>2.5.1</b> Initial data exploration</a></li>
<li class="chapter" data-level="2.5.2" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#synthesis-questions"><i class="fa fa-check"></i><b>2.5.2</b> Synthesis Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="hydrograph-separation-lab-module-20-pts.html"><a href="hydrograph-separation-lab-module-20-pts.html"><i class="fa fa-check"></i><b>3</b> Hydrograph separation: lab module (20 pts)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="hydrograph-separation-lab-module-20-pts.html"><a href="hydrograph-separation-lab-module-20-pts.html#intro"><i class="fa fa-check"></i><b>3.1</b> Intro</a></li>
<li class="chapter" data-level="3.2" data-path="hydrograph-separation-lab-module-20-pts.html"><a href="hydrograph-separation-lab-module-20-pts.html#reading-for-this-lab"><i class="fa fa-check"></i><b>3.2</b> Reading for this lab</a></li>
<li class="chapter" data-level="3.3" data-path="hydrograph-separation-lab-module-20-pts.html"><a href="hydrograph-separation-lab-module-20-pts.html#repo"><i class="fa fa-check"></i><b>3.3</b> Repo</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html"><i class="fa fa-check"></i><b>4</b> Learning module 2 - Return intervals (14 pts)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#background-information"><i class="fa fa-check"></i><b>4.1</b> Background information</a></li>
<li class="chapter" data-level="4.2" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#intro-1"><i class="fa fa-check"></i><b>4.2</b> Intro</a></li>
<li class="chapter" data-level="4.3" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#packages"><i class="fa fa-check"></i><b>4.3</b> Packages</a></li>
<li class="chapter" data-level="4.4" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#precipitation-return-intervals"><i class="fa fa-check"></i><b>4.4</b> Precipitation return intervals</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#q1.-2-pts-what-is-the-probability-that-the-annual-precipitation-in-a-given-year-is-less-than-400-mm-this-is-the-fa-in-the-cdf-in-the-probability-lecture-slides."><i class="fa fa-check"></i><b>4.4.1</b> <strong>Q1. (2 pts) What is the probability that the annual precipitation in a given year is less than 400 mm? This is the F(A) in the CDF in the probability lecture slides.</strong></a></li>
<li class="chapter" data-level="4.4.2" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#q2.-2-pts-what-is-the-probability-that-the-maximum-annual-precipitation-in-a-given-year-is-greater-than-500-mm"><i class="fa fa-check"></i><b>4.4.2</b> <strong>Q2. (2 pts) What is the probability that the maximum annual precipitation in a given year is GREATER than 500 mm?</strong></a></li>
<li class="chapter" data-level="4.4.3" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#q3.-2-pts-what-is-the-probability-that-the-annual-p-is-between-400-and-500-mm"><i class="fa fa-check"></i><b>4.4.3</b> <strong>Q3. (2 pts) What is the probability that the annual P is between 400 and 500 mm?</strong></a></li>
<li class="chapter" data-level="4.4.4" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#q4.-2-pts-what-is-the-return-period-for-a-year-with-at-least-550-mm-of-precip-the-return-period-tr-is-calculated-as-tr-1p-with-p-being-the-probability-for-an-event-to-occur."><i class="fa fa-check"></i><b>4.4.4</b> <strong>Q4. (2 pts) What is the return period for a year with AT LEAST 550 mm of precip? The return period, Tr, is calculated as Tr = 1/p, with p being the probability for an event to occur.</strong></a></li>
<li class="chapter" data-level="4.4.5" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#q5.-6-pts-explain-why-probability-analysis-of-climate-data-assumes-the-data-are-normally-distributed-and-stationary-below-provide-a-histogram-and-a-density-plot-of-the-total-annual-p-data-and-comment-on-the-visual-appearance-in-terms-of-normality.-next-use-google-and-the-links-below-to-test-for-normality-and-stationarity.-be-quantitative-in-commenting-on-the-normality-and-stationarity-of-the-total-p-data."><i class="fa fa-check"></i><b>4.4.5</b> <strong>Q5. (6 pts) Explain why probability analysis of climate data assumes the data are normally distributed and stationary? Below provide a histogram and a density plot of the total annual P data and comment on the visual appearance in terms of normality. Next use google and the links below to test for normality and stationarity. Be quantitative in commenting on the normality and stationarity of the total P data.</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html"><i class="fa fa-check"></i><b>5</b> Rational method and NRCS curve number (14 pts)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#rational-method"><i class="fa fa-check"></i><b>5.1</b> Rational Method</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#background-information-1"><i class="fa fa-check"></i><b>5.1.1</b> Background information</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#curve-number"><i class="fa fa-check"></i><b>5.2</b> Curve Number</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#background-information-2"><i class="fa fa-check"></i><b>5.2.1</b> Background information</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#codework"><i class="fa fa-check"></i><b>5.3</b> Codework</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#packages-1"><i class="fa fa-check"></i><b>5.3.1</b> Packages</a></li>
<li class="chapter" data-level="5.3.2" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#part-i---rational-method"><i class="fa fa-check"></i><b>5.3.2</b> Part I - Rational Method</a></li>
<li class="chapter" data-level="5.3.3" data-path="rational-method-and-nrcs-curve-number-14-pts.html"><a href="rational-method-and-nrcs-curve-number-14-pts.html#part-ii---nrcs-cn"><i class="fa fa-check"></i><b>5.3.3</b> Part II - NRCS CN</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html"><i class="fa fa-check"></i><b>6</b> Transfer function rainfall-runoff models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#summary-1"><i class="fa fa-check"></i><b>6.1</b> 6.1 Summary</a></li>
<li class="chapter" data-level="6.2" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#overall-learning-objectives-1"><i class="fa fa-check"></i><b>6.2</b> 6.2 Overall Learning Objectives</a></li>
<li class="chapter" data-level="6.3" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#terminology"><i class="fa fa-check"></i><b>6.3</b> 6.3 Terminology</a></li>
<li class="chapter" data-level="6.4" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#the-linear-time-invariant-tf"><i class="fa fa-check"></i><b>6.4</b> 6.4 The Linear Time-Invariant TF</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="codework---transfer-function-rainfall-runoff-model.html"><a href="codework---transfer-function-rainfall-runoff-model.html"><i class="fa fa-check"></i><b>7</b> Codework - Transfer function rainfall-runoff model</a>
<ul>
<li class="chapter" data-level="7.0.1" data-path="codework---transfer-function-rainfall-runoff-model.html"><a href="codework---transfer-function-rainfall-runoff-model.html#load-packages-with-a-function-that-checks-and-installs-packages-if-needed"><i class="fa fa-check"></i><b>7.0.1</b> Load packages with a function that checks and installs packages if needed:</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html"><i class="fa fa-check"></i><b>8</b> 7. Monte Carlo Simulation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#background"><i class="fa fa-check"></i><b>8.1</b> 7.1 Background:</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#reading"><i class="fa fa-check"></i><b>8.1.1</b> 7.1.1 - Reading</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#how-does-this-apply-to-hydrological-modeling"><i class="fa fa-check"></i><b>8.2</b> 7.2 How does this apply to hydrological modeling?</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#example"><i class="fa fa-check"></i><b>8.2.1</b> 7.2.1 Example</a></li>
<li class="chapter" data-level="8.2.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#reading-1"><i class="fa fa-check"></i><b>8.2.2</b> 7.2.2 - Reading</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#how-do-we-generate-a-simulation-with-code"><i class="fa fa-check"></i><b>8.3</b> 7.3 How do we generate a simulation with code?</a></li>
<li class="chapter" data-level="8.4" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#assignment"><i class="fa fa-check"></i><b>8.4</b> 7.4 Assignment</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#setup"><i class="fa fa-check"></i><b>8.4.1</b> 7.4.1 Setup</a></li>
<li class="chapter" data-level="8.4.2" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#parameter-initialization"><i class="fa fa-check"></i><b>8.4.2</b> 7.4.2 Parameter initialization</a></li>
<li class="chapter" data-level="8.4.3" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#mc-model-run"><i class="fa fa-check"></i><b>8.4.3</b> 7.4.3 MC Model run</a></li>
<li class="chapter" data-level="8.4.4" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html#sensitivity-analysis"><i class="fa fa-check"></i><b>8.4.4</b> 7.4.4 Sensitivity analysis</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Environmental Methods: LRES 546</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="transfer-function-rainfall-runoff-models" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Transfer function rainfall-runoff models<a href="transfer-function-rainfall-runoff-models.html#transfer-function-rainfall-runoff-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="summary-1" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> 6.1 Summary<a href="transfer-function-rainfall-runoff-models.html#summary-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In previous modules, we explored how watershed characteristics influence the flow of input water through or over hillslopes to quickly contribute to stormflow or to be stored for later contribution to baseflow. Therefore, the partitioning of flow into baseflow or stormflow can be determined by the time it spends in the watershed. Furthermore, the residence time of water in various pathways may affect weathering and solute transport within watersheds. To improve our understanding of water movement within a watershed, it can be crucial to incorporate water transit time into hydrological models. This consideration allows for a more realistic representation of how water moves through various storage compartments, such as soil, groundwater, and surface water, accounting for the time it takes for water to traverse these pathways.</p>
<p>In this module, we will model the temporal aspects of runoff response to input using a transfer function. First, please read: <br/></p>
<p><a href="docs/Weiler_etal_WRR2003.pdf">TRANSEP - a combined tracer and runoff transfer function hydrograph separation model</a>
<br/></p>
<p>Then this chapter will step through key concepts in the paper to facilitate hands-on exploration of the rainfall-runoff portion of the TRANSEP model in the assessment. Then, we will introduce examples of other transfer functions to demonstrate alternative ways of representing time-induced patterns in hydrological modeling, prompting you to consider response patterns in your study systems.</p>
</div>
<div id="overall-learning-objectives-1" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> 6.2 Overall Learning Objectives<a href="transfer-function-rainfall-runoff-models.html#overall-learning-objectives-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At the end of this module, students should be able to describe several ways to model and identify transit time within hydrological models. They should have a general understanding of how water transit time may influence the timing and composition of runoff.</p>
</div>
<div id="terminology" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> 6.3 Terminology<a href="transfer-function-rainfall-runoff-models.html#terminology" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In modeling a flow system, note that consideration of time may vary depending on the questions being asked. <strong>Transit time</strong> is the average time required for water to travel through the entire flow system, from input (e.g., rainfall on soil surface) to output (e.g., discharge). <strong>Residence time</strong> is a portion of transit time, describing the amount of time water spends within a specific component of the flow system, like storage (e.g., in soil, groundwater, or a lake).</p>
<div class="float">
<img src="https://ars.els-cdn.com/content/image/1-s2.0-S0022169406002150-gr1.jpg" alt="Figure 6.3. Conceptual diagram of the lumped parameter transit time modeling approach (McGuire &amp; McDonnell, 2006)" />
<div class="figcaption">Figure 6.3. Conceptual diagram of the lumped parameter transit time modeling approach (McGuire &amp; McDonnell, 2006)</div>
</div>
<p><br/><br/></p>
<p>A <strong>transfer function</strong> (TF) is a mathematical representation of how a system responds to input signals. In a hydrological context, it describes the transformation of inputs (e.g. precipitation) to outputs (e.g. runoff). These models can be valuable tools for understanding the time-varying dynamics of a hydrological system.</p>
</div>
<div id="the-linear-time-invariant-tf" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> 6.4 The Linear Time-Invariant TF<a href="transfer-function-rainfall-runoff-models.html#the-linear-time-invariant-tf" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ll begin the discussion in the context of a <strong>linear reservoir</strong>. Linear reservoirs are simple models designed to simulate the storage and discharge of water in a catchment. These models assume that the catchment can be represented as single storage compartments or as a series of interconnected storage compartments and that the change the amount of water stored in the reservoir (or reservoirs) is directly proportional to the inflows and outflows. In other words, the linear relationship between inflows and outflows means that the rate of water release is proportional to the amount of water stored in the reservoir.</p>
<p><img src="images/linear_storage_04.png" /></p>
<p><br/><br/></p>
<div id="the-instantaneous-unit-hydrograph" class="section level4 hasAnchor" number="6.4.0.1">
<h4><span class="header-section-number">6.4.0.1</span> 6.4.1 The Instantaneous Unit Hydrograph:<a href="transfer-function-rainfall-runoff-models.html#the-instantaneous-unit-hydrograph" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Instantaneous Unit Hydrograph (IUH) represents the linear rainfall-runoff model used in the TRANSEP model. It is an approach to hydrograph separation that is useful for analyzing the temporal distribution of runoff in response to a ‘unit’ pulse of rainfall (e.g. uniform one-inch depth over a unit area represented by a unit hydrograph). In other words, it is a hydrograph that results from one unit (e.g. 1 mm) of effective rainfall uniformly distributed over the watershed and occurring in a short duration. Therefore, the following assumptions are made when the IUH is used as a transfer function: <br/>
1. the IUH reflects the ensemble of watershed characteristics <br/>
2. the shape characteristics of the unit hydrograph are independent of time <br/>
3. the output response is linearly proportional to the input</p>
<p><br/><br/></p>
<div class="float">
<img src="https://echo2.epfl.ch/VICAIRE/mod_1b/chapt_4/pictures/fi1.gif" alt="Figure 6.4.1.a Conceptual diagram of the linear unit hydrograph" />
<div class="figcaption">Figure 6.4.1.a Conceptual diagram of the linear unit hydrograph</div>
</div>
<p><br/><br/></p>
<p>Peak discharge of the unit hydrograph, <span class="math inline">\(u_p\)</span>; <br/>
Base time <span class="math inline">\(t_b\)</span>is the total duration of the unit hydrograph; <br/>
Increase time or time to peak <span class="math inline">\(t_p\)</span> is the time between the start point of the hydrograph and the peak; <br/>
Concentration time <span class="math inline">\(t_c\)</span> is the time between the end of rainfall and the end of the hydrograph; <br/>
Lag time <span class="math inline">\(t_lag\)</span> is the time between half rainfall depth and the peak of the hydrograph. <br/></p>
<p>IUH as a transfer function allows the calculation of the direct runoff hydrograph for any given rainfall input. IUH is particularly valuable for understanding how the direct runoff is distributed over time in response to a rainfall event. It helps quantify the time distribution of runoff in relation to the rainfall input.</p>
<p><br/><br/></p>
<div class="float">
<img src="https://echo2.epfl.ch/VICAIRE/mod_1b/chapt_4/pictures/fi2.gif" alt="Figure 6.4.1.b The discharge of the unit hydrograph(u) from a catchment at time (t) is expressed as h \cdot u(t) where h is the amount of effective rainfall." />
<div class="figcaption">Figure 6.4.1.b The discharge of the unit hydrograph(u) from a catchment at time (t) is expressed as <span class="math inline">\(h \cdot u(t)\)</span> where h is the amount of effective rainfall.</div>
</div>
<p><br/><br/></p>
<p>In the TRANSEP model, this transfer function is represented as <span class="math inline">\(g(\tau)\)</span> and thus the rainfall-induced response to runoff.</p>
<p><span class="math display">\[
g(\tau) = \frac{\tau^{\alpha-1}}{\mathrm{B}^{\alpha}\Gamma(\alpha)}exp(-\frac{\tau}{\alpha})
\]</span>
<br/><br/></p>
<p>The linear portion of the TRANSEP model describes a convolution of the effective precipitation and a runoff transfer function.</p>
<p><span class="math display">\[
Q(t)= \int_{0}^{t} g(\tau)p_{\text{eff}}(t-\tau)d\tau
\]</span>
<br/><br/></p>
<p>Whoa, wait…what? Tau, integrals, and convolution? Don’t worry about the details of the equations. Check out this video to have convolution described using dollars and cookies, then imagine each dollar as a rainfall unit and each cookie as a runoff unit. Review the equations again after the video.</p>
<p><br/><br/></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="transfer-function-rainfall-runoff-models.html#cb28-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_url</span>(<span class="st">&quot;https://www.youtube.com/embed/aEGboJxmq-w&quot;</span>)</span></code></pre></div>
<iframe src="https://www.youtube.com/embed/aEGboJxmq-w" width="672" height="400px" data-external="1">
</iframe>
</div>
<div id="the-loss-function" class="section level4 hasAnchor" number="6.4.0.2">
<h4><span class="header-section-number">6.4.0.2</span> 6.4.2 The Loss Function:<a href="transfer-function-rainfall-runoff-models.html#the-loss-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The loss function represents the linear rainfall-runoff model used in the TRANSEP model.</p>
<p><span class="math display">\[
s(t) = b_{1} p(t + 1 - b_{2}^{-1}) s(t - \triangle t)
\]</span>
<span class="math display">\[
s(t = 0) = b_{3}
\]</span>
<span class="math display">\[
p_{\text{eff}}(t) = p(t) s(t)
\]</span>
where <span class="math inline">\(p_{\text{eff}}(t)\)</span> is the effective precipitation.<br/>
<span class="math inline">\(s(t)\)</span> is the antecedent precipitation index which is determined by giving more importance to recent precipitation and gradually reducing that importance as we go back in time. <br/>
The rate at which this importance decreases is controlled by the parameter <span class="math inline">\(b_{2}\)</span>. <br/>
The parameter <span class="math inline">\(b_{3}\)</span> sets the initial antecedent precipitation index at the beginning of the simulated time series.</p>
<p>In other words, these equations are used to simulate the flow of water in a hydrological system over time. The first equation represents the change in stored water at each time step, taking into account precipitation, loss to runoff, and the system’s past state. The second equation sets the initial condition for the storage at the beginning of the simulation. The third equation calculates the effective precipitation, considering both precipitation and the current storage state.</p>
</div>
<div id="how-do-we-code-this" class="section level4 hasAnchor" number="6.4.0.3">
<h4><span class="header-section-number">6.4.0.3</span> 6.4.3 How do we code this?<a href="transfer-function-rainfall-runoff-models.html#how-do-we-code-this" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We will use a skeletal version of TRANSEP, focusing only on the rainfall-runoff piece which includes the loss-function and the gamma transfer function.</p>
<p>We will use rainfall and runoff data from TCEF to model annual streamflow at a daily time step. Then we can use this model as a jump-off point to start talking about model calibration and validation in future modules.</p>
</div>
<div id="final-thoughts" class="section level4 hasAnchor" number="6.4.0.4">
<h4><span class="header-section-number">6.4.0.4</span> 6…Final thoughts:<a href="transfer-function-rainfall-runoff-models.html#final-thoughts" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If during your modeling experience, you find yourself wading through a bog of complex physics and multiple layers of transfer functions to account for every drop of input into a system, it is time to revisit your objectives. Remember that a model is always ‘wrong’. Like a map, it provides a simplified representation of reality. It may not be entirely accurate, but it serves a valuable purpose. Models help us understand complex systems, make predictions, and gain insights even if they are not an exact replica of the real world. Check out this paper for more:</p>
<p><a href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/93WR00877" class="uri">https://agupubs.onlinelibrary.wiley.com/doi/10.1029/93WR00877</a></p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rational-method-and-nrcs-curve-number-14-pts.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="codework---transfer-function-rainfall-runoff-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tpcovino/lres_546_bookdown/edit/main/06_transfer_function_lecture_and_lab.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/tpcovino/lres_546_bookdown/blob/main/06_transfer_function_lecture_and_lab.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
