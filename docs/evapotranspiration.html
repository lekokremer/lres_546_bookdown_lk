<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Evapotranspiration | Quantitative Environmental Methods: LRES 546</title>
  <meta name="description" content="Chapter 12 Evapotranspiration | Quantitative Environmental Methods: LRES 546" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Evapotranspiration | Quantitative Environmental Methods: LRES 546" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Evapotranspiration | Quantitative Environmental Methods: LRES 546" />
  
  
  

<meta name="author" content="Tim Covino &amp; Lauren Kremer" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dem-processing.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">lres_546</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-overview-and-objectives"><i class="fa fa-check"></i><b>1.1</b> Course overview and objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i><b>1.2</b> Course Description</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i><b>1.3</b> Structure</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#philosophical-approach-and-resources"><i class="fa fa-check"></i><b>1.4</b> Philosophical approach and resources</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#tentative-schedule-subject-to-change"><i class="fa fa-check"></i><b>1.5</b> Tentative schedule, subject to change</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html"><i class="fa fa-check"></i><b>2</b> Hydrograph separation: learning module</a>
<ul>
<li class="chapter" data-level="2.1" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#summary"><i class="fa fa-check"></i><b>2.1</b> Summary</a></li>
<li class="chapter" data-level="2.2" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#overall-learning-objectives"><i class="fa fa-check"></i><b>2.2</b> Overall Learning Objectives</a></li>
<li class="chapter" data-level="2.3" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#lecture"><i class="fa fa-check"></i><b>2.3</b> Lecture</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#components-of-streamflow-during-a-rain-event"><i class="fa fa-check"></i><b>2.3.1</b> Components of streamflow during a rain event</a></li>
<li class="chapter" data-level="2.3.2" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#storm-flow-through-a-hillslope"><i class="fa fa-check"></i><b>2.3.2</b> Storm flow through a hillslope</a></li>
<li class="chapter" data-level="2.3.3" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#how-we-quantify-baseflow"><i class="fa fa-check"></i><b>2.3.3</b> How we quantify baseflow</a></li>
<li class="chapter" data-level="2.3.4" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#baseflow-separation-methods"><i class="fa fa-check"></i><b>2.3.4</b> Baseflow separation methods</a></li>
<li class="chapter" data-level="2.3.5" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#watershed-controls-on-baseflow-and-stormflow"><i class="fa fa-check"></i><b>2.3.5</b> Watershed controls on baseflow and stormflow</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#assessment"><i class="fa fa-check"></i><b>2.4</b> Assessment</a></li>
<li class="chapter" data-level="2.5" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#interactive-application-and-questions"><i class="fa fa-check"></i><b>2.5</b> Interactive application and questions</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#initial-data-exploration"><i class="fa fa-check"></i><b>2.5.1</b> Initial data exploration</a></li>
<li class="chapter" data-level="2.5.2" data-path="hydrograph-separation-learning-module.html"><a href="hydrograph-separation-learning-module.html#synthesis-questions"><i class="fa fa-check"></i><b>2.5.2</b> Synthesis Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="hydrograph-separation-lab-module-20-pts.html"><a href="hydrograph-separation-lab-module-20-pts.html"><i class="fa fa-check"></i><b>3</b> Hydrograph separation: lab module (20 pts)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="hydrograph-separation-lab-module-20-pts.html"><a href="hydrograph-separation-lab-module-20-pts.html#intro"><i class="fa fa-check"></i><b>3.1</b> Intro</a></li>
<li class="chapter" data-level="3.2" data-path="hydrograph-separation-lab-module-20-pts.html"><a href="hydrograph-separation-lab-module-20-pts.html#reading-for-this-lab"><i class="fa fa-check"></i><b>3.2</b> Reading for this lab</a></li>
<li class="chapter" data-level="3.3" data-path="hydrograph-separation-lab-module-20-pts.html"><a href="hydrograph-separation-lab-module-20-pts.html#repo"><i class="fa fa-check"></i><b>3.3</b> Repo</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html"><i class="fa fa-check"></i><b>4</b> Learning module 2 - Return intervals (14 pts)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#background-information"><i class="fa fa-check"></i><b>4.1</b> Background information</a></li>
<li class="chapter" data-level="4.2" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#intro-1"><i class="fa fa-check"></i><b>4.2</b> Intro</a></li>
<li class="chapter" data-level="4.3" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#packages"><i class="fa fa-check"></i><b>4.3</b> Packages</a></li>
<li class="chapter" data-level="4.4" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#precipitation-return-intervals"><i class="fa fa-check"></i><b>4.4</b> Precipitation return intervals</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#q1.-2-pts-what-is-the-probability-that-the-annual-precipitation-in-a-given-year-is-less-than-400-mm-this-is-the-fa-in-the-cdf-in-the-probability-lecture-slides."><i class="fa fa-check"></i><b>4.4.1</b> <strong>Q1. (2 pts) What is the probability that the annual precipitation in a given year is less than 400 mm? This is the F(A) in the CDF in the probability lecture slides.</strong></a></li>
<li class="chapter" data-level="4.4.2" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#q2.-2-pts-what-is-the-probability-that-the-maximum-annual-precipitation-in-a-given-year-is-greater-than-500-mm"><i class="fa fa-check"></i><b>4.4.2</b> <strong>Q2. (2 pts) What is the probability that the maximum annual precipitation in a given year is GREATER than 500 mm?</strong></a></li>
<li class="chapter" data-level="4.4.3" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#q3.-2-pts-what-is-the-probability-that-the-annual-p-is-between-400-and-500-mm"><i class="fa fa-check"></i><b>4.4.3</b> <strong>Q3. (2 pts) What is the probability that the annual P is between 400 and 500 mm?</strong></a></li>
<li class="chapter" data-level="4.4.4" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#q4.-2-pts-what-is-the-return-period-for-a-year-with-at-least-550-mm-of-precip-the-return-period-tr-is-calculated-as-tr-1p-with-p-being-the-probability-for-an-event-to-occur."><i class="fa fa-check"></i><b>4.4.4</b> <strong>Q4. (2 pts) What is the return period for a year with AT LEAST 550 mm of precip? The return period, Tr, is calculated as Tr = 1/p, with p being the probability for an event to occur.</strong></a></li>
<li class="chapter" data-level="4.4.5" data-path="learning-module-2---return-intervals-14-pts.html"><a href="learning-module-2---return-intervals-14-pts.html#q5.-6-pts-explain-why-probability-analysis-of-climate-data-assumes-the-data-are-normally-distributed-and-stationary-below-provide-a-histogram-and-a-density-plot-of-the-total-annual-p-data-and-comment-on-the-visual-appearance-in-terms-of-normality.-next-use-google-and-the-links-below-to-test-for-normality-and-stationarity.-be-quantitative-in-commenting-on-the-normality-and-stationarity-of-the-total-p-data."><i class="fa fa-check"></i><b>4.4.5</b> <strong>Q5. (6 pts) Explain why probability analysis of climate data assumes the data are normally distributed and stationary? Below provide a histogram and a density plot of the total annual P data and comment on the visual appearance in terms of normality. Next use google and the links below to test for normality and stationarity. Be quantitative in commenting on the normality and stationarity of the total P data.</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rational-method-and-nrcs-curve-number-20-pts.html"><a href="rational-method-and-nrcs-curve-number-20-pts.html"><i class="fa fa-check"></i><b>5</b> Rational method and NRCS curve number (20 pts)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="rational-method-and-nrcs-curve-number-20-pts.html"><a href="rational-method-and-nrcs-curve-number-20-pts.html#rational-method"><i class="fa fa-check"></i><b>5.1</b> Rational Method</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="rational-method-and-nrcs-curve-number-20-pts.html"><a href="rational-method-and-nrcs-curve-number-20-pts.html#background-information-1"><i class="fa fa-check"></i><b>5.1.1</b> Background information</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="rational-method-and-nrcs-curve-number-20-pts.html"><a href="rational-method-and-nrcs-curve-number-20-pts.html#curve-number"><i class="fa fa-check"></i><b>5.2</b> Curve Number</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="rational-method-and-nrcs-curve-number-20-pts.html"><a href="rational-method-and-nrcs-curve-number-20-pts.html#background-information-2"><i class="fa fa-check"></i><b>5.2.1</b> Background information</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="rational-method-and-nrcs-curve-number-20-pts.html"><a href="rational-method-and-nrcs-curve-number-20-pts.html#codework"><i class="fa fa-check"></i><b>5.3</b> Codework</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="rational-method-and-nrcs-curve-number-20-pts.html"><a href="rational-method-and-nrcs-curve-number-20-pts.html#packages-1"><i class="fa fa-check"></i><b>5.3.1</b> Packages</a></li>
<li class="chapter" data-level="5.3.2" data-path="rational-method-and-nrcs-curve-number-20-pts.html"><a href="rational-method-and-nrcs-curve-number-20-pts.html#part-i---rational-method"><i class="fa fa-check"></i><b>5.3.2</b> Part I - Rational Method</a></li>
<li class="chapter" data-level="5.3.3" data-path="rational-method-and-nrcs-curve-number-20-pts.html"><a href="rational-method-and-nrcs-curve-number-20-pts.html#part-ii---nrcs-cn"><i class="fa fa-check"></i><b>5.3.3</b> Part II - NRCS CN</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html"><i class="fa fa-check"></i><b>6</b> Transfer function rainfall-runoff models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#summary-1"><i class="fa fa-check"></i><b>6.1</b> Summary</a></li>
<li class="chapter" data-level="6.2" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#overall-learning-objectives-1"><i class="fa fa-check"></i><b>6.2</b> Overall Learning Objectives</a></li>
<li class="chapter" data-level="6.3" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#terminology"><i class="fa fa-check"></i><b>6.3</b> Terminology</a></li>
<li class="chapter" data-level="6.4" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#the-linear-time-invariant-tf"><i class="fa fa-check"></i><b>6.4</b> The Linear Time-Invariant TF</a></li>
<li class="chapter" data-level="6.5" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#codework---transfer-function-rainfall-runoff-model"><i class="fa fa-check"></i><b>6.5</b> Codework - Transfer function rainfall-runoff model</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="transfer-function-rainfall-runoff-models.html"><a href="transfer-function-rainfall-runoff-models.html#download-the-repo-for-this-lab-here"><i class="fa fa-check"></i><b>6.5.1</b> Download the repo for this lab HERE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="monte-carlo-simulation-20-pnts.html"><a href="monte-carlo-simulation-20-pnts.html"><i class="fa fa-check"></i><b>7</b> Monte Carlo Simulation (20 pnts)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="monte-carlo-simulation-20-pnts.html"><a href="monte-carlo-simulation-20-pnts.html#background"><i class="fa fa-check"></i><b>7.1</b> Background:</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="monte-carlo-simulation-20-pnts.html"><a href="monte-carlo-simulation-20-pnts.html#reading"><i class="fa fa-check"></i><b>7.1.1</b> Reading</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="monte-carlo-simulation-20-pnts.html"><a href="monte-carlo-simulation-20-pnts.html#how-does-this-apply-to-hydrological-modeling"><i class="fa fa-check"></i><b>7.2</b> How does this apply to hydrological modeling?</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="monte-carlo-simulation-20-pnts.html"><a href="monte-carlo-simulation-20-pnts.html#example"><i class="fa fa-check"></i><b>7.2.1</b> Example</a></li>
<li class="chapter" data-level="7.2.2" data-path="monte-carlo-simulation-20-pnts.html"><a href="monte-carlo-simulation-20-pnts.html#reading-1"><i class="fa fa-check"></i><b>7.2.2</b> Reading</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="monte-carlo-simulation-20-pnts.html"><a href="monte-carlo-simulation-20-pnts.html#how-do-we-generate-a-simulation-with-code"><i class="fa fa-check"></i><b>7.3</b> How do we generate a simulation with code?</a></li>
<li class="chapter" data-level="7.4" data-path="monte-carlo-simulation-20-pnts.html"><a href="monte-carlo-simulation-20-pnts.html#codework-1"><i class="fa fa-check"></i><b>7.4</b> Codework</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="monte-carlo-simulation-20-pnts.html"><a href="monte-carlo-simulation-20-pnts.html#download-the-repo-for-this-lab-here-1"><i class="fa fa-check"></i><b>7.4.1</b> Download the repo for this lab HERE</a></li>
<li class="chapter" data-level="7.4.2" data-path="monte-carlo-simulation-20-pnts.html"><a href="monte-carlo-simulation-20-pnts.html#setup"><i class="fa fa-check"></i><b>7.4.2</b> Setup</a></li>
<li class="chapter" data-level="7.4.3" data-path="monte-carlo-simulation-20-pnts.html"><a href="monte-carlo-simulation-20-pnts.html#parameter-initialization"><i class="fa fa-check"></i><b>7.4.3</b> Parameter initialization</a></li>
<li class="chapter" data-level="7.4.4" data-path="monte-carlo-simulation-20-pnts.html"><a href="monte-carlo-simulation-20-pnts.html#mc-model-run"><i class="fa fa-check"></i><b>7.4.4</b> MC Model run</a></li>
<li class="chapter" data-level="7.4.5" data-path="monte-carlo-simulation-20-pnts.html"><a href="monte-carlo-simulation-20-pnts.html#sensitivity-analysis"><i class="fa fa-check"></i><b>7.4.5</b> Sensitivity analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="classifying-model-structure---lecture-only-0-pts.html"><a href="classifying-model-structure---lecture-only-0-pts.html"><i class="fa fa-check"></i><b>8</b> Classifying model structure - Lecture only (0 pts)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="classifying-model-structure---lecture-only-0-pts.html"><a href="classifying-model-structure---lecture-only-0-pts.html#spatial-complexity"><i class="fa fa-check"></i><b>8.1</b> Spatial Complexity</a></li>
<li class="chapter" data-level="8.2" data-path="classifying-model-structure---lecture-only-0-pts.html"><a href="classifying-model-structure---lecture-only-0-pts.html#modeling-approaches"><i class="fa fa-check"></i><b>8.2</b> Modeling Approaches</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html"><a href="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html"><i class="fa fa-check"></i><b>9</b> Snowmelt Models for runoff timing - Lecture &amp; Lab (20 pts)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html"><a href="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html#module-repo"><i class="fa fa-check"></i><b>9.1</b> Module repo</a></li>
<li class="chapter" data-level="9.2" data-path="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html"><a href="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html#background-1"><i class="fa fa-check"></i><b>9.2</b> Background:</a></li>
<li class="chapter" data-level="9.3" data-path="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html"><a href="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html#model-approaches"><i class="fa fa-check"></i><b>9.3</b> Model Approaches</a></li>
<li class="chapter" data-level="9.4" data-path="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html"><a href="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html#spatial-complexity-1"><i class="fa fa-check"></i><b>9.4</b> Spatial complexity</a></li>
<li class="chapter" data-level="9.5" data-path="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html"><a href="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html#model-choices-my-snow-is-different-from-your-snow"><i class="fa fa-check"></i><b>9.5</b> Model choices: My snow is different from your snow</a></li>
<li class="chapter" data-level="9.6" data-path="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html"><a href="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html#codework-2"><i class="fa fa-check"></i><b>9.6</b> Codework</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html"><a href="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html#download-the-repo-for-this-lab-here-2"><i class="fa fa-check"></i><b>9.6.1</b> Download the repo for this lab HERE</a></li>
<li class="chapter" data-level="9.6.2" data-path="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html"><a href="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html#import-data"><i class="fa fa-check"></i><b>9.6.2</b> Import data:</a></li>
<li class="chapter" data-level="9.6.3" data-path="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html"><a href="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html#calculate-liquid-input"><i class="fa fa-check"></i><b>9.6.3</b> Calculate liquid input</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html"><a href="snowmelt-models-for-runoff-timing---lecture-lab-20-pts.html#modeling-swe"><i class="fa fa-check"></i><b>9.7</b> Modeling SWE</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="learning-module-10---gridded-and-tabular-data-retrieval.html"><a href="learning-module-10---gridded-and-tabular-data-retrieval.html"><i class="fa fa-check"></i><b>10</b> Learning Module 10 - Gridded and tabular data retrieval</a>
<ul>
<li class="chapter" data-level="10.1" data-path="learning-module-10---gridded-and-tabular-data-retrieval.html"><a href="learning-module-10---gridded-and-tabular-data-retrieval.html#objectives"><i class="fa fa-check"></i><b>10.1</b> Objectives</a></li>
<li class="chapter" data-level="10.2" data-path="learning-module-10---gridded-and-tabular-data-retrieval.html"><a href="learning-module-10---gridded-and-tabular-data-retrieval.html#background-2"><i class="fa fa-check"></i><b>10.2</b> Background</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="learning-module-10---gridded-and-tabular-data-retrieval.html"><a href="learning-module-10---gridded-and-tabular-data-retrieval.html#a-refresher-in-gis-concepts"><i class="fa fa-check"></i><b>10.2.1</b> A refresher in GIS concepts:</a></li>
<li class="chapter" data-level="10.2.2" data-path="learning-module-10---gridded-and-tabular-data-retrieval.html"><a href="learning-module-10---gridded-and-tabular-data-retrieval.html#a-refresher-in-remote-sensing"><i class="fa fa-check"></i><b>10.2.2</b> A refresher in remote sensing:</a></li>
<li class="chapter" data-level="10.2.3" data-path="learning-module-10---gridded-and-tabular-data-retrieval.html"><a href="learning-module-10---gridded-and-tabular-data-retrieval.html#ethical-conduct"><i class="fa fa-check"></i><b>10.2.3</b> Ethical conduct</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="learning-module-10---gridded-and-tabular-data-retrieval.html"><a href="learning-module-10---gridded-and-tabular-data-retrieval.html#codework-3"><i class="fa fa-check"></i><b>10.3</b> Codework</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="learning-module-10---gridded-and-tabular-data-retrieval.html"><a href="learning-module-10---gridded-and-tabular-data-retrieval.html#setup-1"><i class="fa fa-check"></i><b>10.3.1</b> Setup:<br></a></li>
<li class="chapter" data-level="10.3.2" data-path="learning-module-10---gridded-and-tabular-data-retrieval.html"><a href="learning-module-10---gridded-and-tabular-data-retrieval.html#selecting-a-watershed"><i class="fa fa-check"></i><b>10.3.2</b> Selecting a watershed:</a></li>
<li class="chapter" data-level="10.3.3" data-path="learning-module-10---gridded-and-tabular-data-retrieval.html"><a href="learning-module-10---gridded-and-tabular-data-retrieval.html#flow-data-retrieval"><i class="fa fa-check"></i><b>10.3.3</b> Flow data retrieval:</a></li>
<li class="chapter" data-level="10.3.4" data-path="learning-module-10---gridded-and-tabular-data-retrieval.html"><a href="learning-module-10---gridded-and-tabular-data-retrieval.html#watershed-boundary-vector-data"><i class="fa fa-check"></i><b>10.3.4</b> Watershed boundary vector data:</a></li>
<li class="chapter" data-level="10.3.5" data-path="learning-module-10---gridded-and-tabular-data-retrieval.html"><a href="learning-module-10---gridded-and-tabular-data-retrieval.html#digital-elevation-models-dem"><i class="fa fa-check"></i><b>10.3.5</b> Digital Elevation Models (DEM)</a></li>
<li class="chapter" data-level="10.3.6" data-path="learning-module-10---gridded-and-tabular-data-retrieval.html"><a href="learning-module-10---gridded-and-tabular-data-retrieval.html#other-remotely-sensed-data"><i class="fa fa-check"></i><b>10.3.6</b> Other remotely sensed data:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="dem-processing.html"><a href="dem-processing.html"><i class="fa fa-check"></i><b>11</b> DEM processing</a>
<ul>
<li class="chapter" data-level="11.1" data-path="dem-processing.html"><a href="dem-processing.html#the-link-to-the-repo-is-here"><i class="fa fa-check"></i><b>11.1</b> THE LINK TO THE REPO IS HERE</a></li>
<li class="chapter" data-level="11.2" data-path="dem-processing.html"><a href="dem-processing.html#objective"><i class="fa fa-check"></i><b>11.2</b> Objective:</a></li>
<li class="chapter" data-level="11.3" data-path="dem-processing.html"><a href="dem-processing.html#background-3"><i class="fa fa-check"></i><b>11.3</b> Background:</a></li>
<li class="chapter" data-level="11.4" data-path="dem-processing.html"><a href="dem-processing.html#codework-4"><i class="fa fa-check"></i><b>11.4</b> Codework</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="dem-processing.html"><a href="dem-processing.html#installing-libraries"><i class="fa fa-check"></i><b>11.4.1</b> Installing libraries</a></li>
<li class="chapter" data-level="11.4.2" data-path="dem-processing.html"><a href="dem-processing.html#generate-functions"><i class="fa fa-check"></i><b>11.4.2</b> Generate functions</a></li>
<li class="chapter" data-level="11.4.3" data-path="dem-processing.html"><a href="dem-processing.html#establish-new-directoriesfolders"><i class="fa fa-check"></i><b>11.4.3</b> Establish new directories(folders)</a></li>
<li class="chapter" data-level="11.4.4" data-path="dem-processing.html"><a href="dem-processing.html#resample-dems"><i class="fa fa-check"></i><b>11.4.4</b> Resample DEMs</a></li>
<li class="chapter" data-level="11.4.5" data-path="dem-processing.html"><a href="dem-processing.html#filling-and-breaching"><i class="fa fa-check"></i><b>11.4.5</b> Filling and breaching</a></li>
<li class="chapter" data-level="11.4.6" data-path="dem-processing.html"><a href="dem-processing.html#flow-direction-and-accumulation-rasters"><i class="fa fa-check"></i><b>11.4.6</b> Flow direction and accumulation rasters</a></li>
<li class="chapter" data-level="11.4.7" data-path="dem-processing.html"><a href="dem-processing.html#streams"><i class="fa fa-check"></i><b>11.4.7</b> Streams</a></li>
<li class="chapter" data-level="11.4.8" data-path="dem-processing.html"><a href="dem-processing.html#final-thoughts-1"><i class="fa fa-check"></i><b>11.4.8</b> Final thoughts:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="evapotranspiration.html"><a href="evapotranspiration.html"><i class="fa fa-check"></i><b>12</b> Evapotranspiration</a>
<ul>
<li class="chapter" data-level="12.1" data-path="evapotranspiration.html"><a href="evapotranspiration.html#the-repo-can-be-found-here"><i class="fa fa-check"></i><b>12.1</b> The repo can be found here</a></li>
<li class="chapter" data-level="12.2" data-path="evapotranspiration.html"><a href="evapotranspiration.html#background-4"><i class="fa fa-check"></i><b>12.2</b> Background</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="evapotranspiration.html"><a href="evapotranspiration.html#transpiration"><i class="fa fa-check"></i><b>12.2.1</b> Transpiration</a></li>
<li class="chapter" data-level="12.2.2" data-path="evapotranspiration.html"><a href="evapotranspiration.html#measurements"><i class="fa fa-check"></i><b>12.2.2</b> Measurements</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="evapotranspiration.html"><a href="evapotranspiration.html#codework-5"><i class="fa fa-check"></i><b>12.3</b> Codework:</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="evapotranspiration.html"><a href="evapotranspiration.html#the-evapotranspiration-package"><i class="fa fa-check"></i><b>12.3.1</b> The Evapotranspiration package</a></li>
<li class="chapter" data-level="12.3.2" data-path="evapotranspiration.html"><a href="evapotranspiration.html#the-priestly-taylor-method-actual-evapotranspiration"><i class="fa fa-check"></i><b>12.3.2</b> The Priestly Taylor method (actual evapotranspiration)</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Environmental Methods: LRES 546</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="evapotranspiration" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> Evapotranspiration<a href="evapotranspiration.html#evapotranspiration" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="the-repo-can-be-found-here" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> The repo can be found <a href="https://github.com/tpcovino/09_evapotranspiration" target="blank">here</a><a href="evapotranspiration.html#the-repo-can-be-found-here" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>15pnts<br></p>
</div>
<div id="background-4" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Background<a href="evapotranspiration.html#background-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Evapotranspiration (ET) encompasses all processes through which water moves from the Earth’s surface to the atmosphere, comprising both evaporation and transpiration. This includes water vaporizing into the air from soil surfaces, the capillary fringe of groundwater, and water bodies on land.
Much like snowmelt modeling, ET modeling and measurements are critical to many fields and could be a full course on its own. We will be focused on the basics of ET, modeling and data retrieval methods for water balance in hydrological modeling. Evapotranspiration is an important variable in hydrological models, as it accounts for much of the water loss in a system, outside of discharge.
Transpiration, a significant component of ET, involves the movement of water from soil to atmosphere through plants. This occurs as plants absorb liquid water from the soil and release water vapor through their leaves. To gain a deeper understanding of ET, let’s review transpiration.</p>
<div id="transpiration" class="section level3 hasAnchor" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> Transpiration<a href="evapotranspiration.html#transpiration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plant root systems to absorb water and nutrients from the soil, which they then distribute to their stems and leaves. As part of this process, plants regulate the loss of water vapor into the atmosphere through stomatal apertures, or transpiration. However, the volume of water transpired can vary widely due to factors like weather conditions and plant traits.</p>
<p>Vegetation type: Plants transpire water at different rates. Some plants in arid regions have evolved mechanisms to conserve water by reducing transpiration. One mechanism involves regulating stomatal opening and closure. These plants can minimize water loss, especially during periods of high heat and low humidity. This closure of stomata can lead to diel and seasonal patterns in transpiration rates. Throughout the day, when environmental conditions are favorable for photosynthesis, stomata open to allow gas exchange, leading to increased transpiration. Conversely, during the night or under stressful conditions, stomata may close to conserve water, resulting in reduced transpiration rates.</p>
<p>Humidity: As the relative humidity of the air surrounding the plant rises the transpiration rate falls. It is easier for water to evaporate into dryer air than into more saturated air.</p>
<p>Soil type and saturation: Clay particles, being small, have a high capacity to retain water, while sand particles, being larger, readily release water. When there is a shortage of moisture, plants may enter a state of senescence and reduce their rate of transpiration.</p>
<p>Precipitation: During dry periods, transpiration can contribute to the loss of moisture in the upper soil zone.</p>
<p>Temperature: Transpiration rates go up as the temperature goes up, especially during the growing season, when the air is warmer due to stronger sunlight and warmer air masses. Higher temperatures cause the plant cells to open stomata, allowing for the exchange of CO2 and water with the atmosphere, whereas colder temperatures cause the openings to close.</p>
<p>The availability and intensity of sunlight have a direct impact on transpiration rates. Likewise, the aspect of a location can influence transpiration since sunlight availability often depends on it.</p>
<p>Wind &amp; air movement: Increased movement of the air around a plant will result in a higher transpiration rate. Wind will move the air around, with the result that the more saturated air close to the leaf is replaced by drier air.</p>
</div>
<div id="measurements" class="section level3 hasAnchor" number="12.2.2">
<h3><span class="header-section-number">12.2.2</span> Measurements<a href="evapotranspiration.html#measurements" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the realm of evapotranspiration (ET) modeling and data analysis, you’ll frequently encounter the terms potential ET and actual ET. These terms are important to consider when selecting data, as they offer very different insights into water loss processes from the land surface to the atmosphere.</p>
<p>Potential Evapotranspiration (PET): Potential ET refers to the maximum possible rate at which water could evaporate and transpire under ideal conditions. These conditions typically assume an ample supply of water, unrestricted soil moisture availability, and sufficient energy to drive the evaporative processes. PET is often estimated based on meteorological variables such as temperature, humidity, wind speed, and solar radiation using empirical equations like the Penman-Monteith equation.</p>
<p>Actual Evapotranspiration (AET): Actual ET, on the other hand, represents the observed or estimated rate at which water is actually evaporating and transpiring from the land surface under existing environmental conditions. Unlike PET, AET accounts for factors such as soil moisture availability, vegetation cover, stomatal conductance, and atmospheric demand. It reflects the true water loss from the ecosystem and is of greater interest in hydrological modeling, as it provides a more realistic depiction of water balance dynamics.</p>
<p>The formula for converting PET to AET is:</p>
<p>AET = PET * Kc</p>
<p>Where:</p>
<p>AET is the actual evapotranspiration,
PET is the potential evapotranspiration, and
Kc is the crop coefficient.
The crop coefficient accounts for factors such as crop type, soil moisture levels, climate conditions, and management practices. It can vary throughout the growing season as well.</p>
<div id="direct-measurements" class="section level4 hasAnchor" number="12.2.2.1">
<h4><span class="header-section-number">12.2.2.1</span> Direct measurements:<a href="evapotranspiration.html#direct-measurements" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are several methods to measure ET directly like lysimeters and gravimetric analysis, but this data rarely available to the public. There has been a concerted effort to enhance the accessibility of Eddy Covariance data, so this dataset may expand in the years to come.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="evapotranspiration.html#cb101-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_url</span>(<span class="st">&quot;https://www.youtube.com/embed/CR4Anc8Mkas&quot;</span>)</span></code></pre></div>
<iframe src="https://www.youtube.com/embed/CR4Anc8Mkas" width="672" height="400px" data-external="1">
</iframe>
<p>This video focuses on CO2 as an output of eddy covariance data, but among the ‘other gases’ mentioned, water vapor is included, offering measurements of actual ET. The video also provides a resource where you might find eddy covariance data for your region of interest.</p>
</div>
<div id="remote-sensing" class="section level4 hasAnchor" number="12.2.2.2">
<h4><span class="header-section-number">12.2.2.2</span> Remote sensing:<a href="evapotranspiration.html#remote-sensing" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Remote sensing of evapotranspiration (ET) involves the use of satellite or airborne sensors to observe and quantify the exchange of water vapor between the Earth’s surface and the atmosphere over large spatial scales. This approach offers several advantages, including the ability to monitor ET across diverse landscapes, regardless of accessibility, and to capture variations in ET over time with high temporal resolution.</p>
<p>Remote sensing data, coupled with energy balance models, can be used to estimate ET by quantifying the energy fluxes at the land surface. These models balance incoming solar radiation with outgoing energy fluxes, including sensible heat flux and latent heat flux (representing ET). Remote sensing-based ET estimates are often validated and calibrated using ground-based measurements, such as eddy covariance towers or lysimeters, to ensure accuracy and reliability. It can be helpful to validate these models yourself if you have a data source available in your ecoregion as a ‘sanity check’. Keep in mind that there are numerous models available, some of which may be tailored for specific ecoregions, resulting in significant variations in estimated evapotranspiration (ET) for your area among these models. If directly measured ET data is not available, you can check model output in a simple water balance. For example, inputs - outputs for your watershed (Ppt - Q - ET) should be <em>approximately</em> 0 (recall from our transfer function module that it is likely not exact). If the ET estimate matches precipitation, it’s likely that the selected model is overestimating ET for your region.</p>
<p>Some resources for finding ET modeled from remote sensing data:</p>
<p><a href="https://app.climateengine.org/climateEngine">ClimateEngine.org</a> - This is a fun resource for all kinds of data. Actual evapotranspiration can be found in the TerraClimate dataset.</p>
<p><a href="https://etdata.org/">OpenET</a> - you need a Google account for this one. This site is great if you need timeseries data. You can select ‘gridded data’ and draw a polygon in your area of interest. You can select the year of interest at the top of the map, and once the timeseries generates, you can view and compare the output of seven different models.</p>
</div>
<div id="modeling" class="section level4 hasAnchor" number="12.2.2.3">
<h4><span class="header-section-number">12.2.2.3</span> Modeling:<a href="evapotranspiration.html#modeling" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
</div>
<div id="codework-5" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Codework:<a href="evapotranspiration.html#codework-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this assignment, we will work again in the Fraser Experimental Forest (same site as snowmelt module). Not only are there meteorological stations in our watershed of interest, but there is a Eddy Covariance tower nearby, in a forest with the same tree community as our watershed of interest. We can use this data to verify our model output for modeled data.</p>
<div id="the-evapotranspiration-package" class="section level3 hasAnchor" number="12.3.1">
<h3><span class="header-section-number">12.3.1</span> The <a href="https://cran.r-project.org/web/packages/Evapotranspiration/index.html">Evapotranspiration package</a><a href="evapotranspiration.html#the-evapotranspiration-package" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will test a couple of simple methods that require few data inputs. However, it may be helpful to know that this package will allow calculations of PET, AET and Reference Crop Evapotranspiration from many different equations. Your selection of models may depend on the study region and the data available.</p>
<div id="import-libraries" class="section level4 hasAnchor" number="12.3.1.1">
<h4><span class="header-section-number">12.3.1.1</span> Import libraries<a href="evapotranspiration.html#import-libraries" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="import-data-1" class="section level4 hasAnchor" number="12.3.1.2">
<h4><span class="header-section-number">12.3.1.2</span> Import data<a href="evapotranspiration.html#import-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="meteorological-data" class="section level5 hasAnchor" number="12.3.1.2.1">
<h5><span class="header-section-number">12.3.1.2.1</span> Meteorological data<a href="evapotranspiration.html#meteorological-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>We’ll import three datasets in this workflow, one containing actual data from the eddy covariance tower for the years 2017-2018. <br>
Also imported is the discharge (Q) data from our watershed. Note that data is not collected during periods of deep snow. We will use this data to estimate the total discharge for 2022. <br>
Additionally, we’ll import the meteorological data from our watershed for the years of interest. We are going to estimate ET for our watershed during the 2022 water year, though met data is provided in calendar years, so we will need to extract the desired data from the met dataframe.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="evapotranspiration.html#cb102-1" tabindex="-1"></a><span class="co"># # We have two meteorological (met) files in the working directory, </span></span>
<span id="cb102-2"><a href="evapotranspiration.html#cb102-2" tabindex="-1"></a><span class="co"># # List all files in the directory</span></span>
<span id="cb102-3"><a href="evapotranspiration.html#cb102-3" tabindex="-1"></a><span class="co"># file_list &lt;- list.files(pattern = &quot;\\.csv$&quot;)</span></span>
<span id="cb102-4"><a href="evapotranspiration.html#cb102-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb102-5"><a href="evapotranspiration.html#cb102-5" tabindex="-1"></a><span class="co"># # Filter filenames containing &#39;met&#39;</span></span>
<span id="cb102-6"><a href="evapotranspiration.html#cb102-6" tabindex="-1"></a><span class="co"># met_files &lt;- file_list[grep(&quot;met&quot;, file_list)]</span></span>
<span id="cb102-7"><a href="evapotranspiration.html#cb102-7" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb102-8"><a href="evapotranspiration.html#cb102-8" tabindex="-1"></a><span class="co"># # Read in and concatenate the &#39;met&#39; files</span></span>
<span id="cb102-9"><a href="evapotranspiration.html#cb102-9" tabindex="-1"></a><span class="co"># data_list &lt;- lapply(met_files, read.csv)</span></span>
<span id="cb102-10"><a href="evapotranspiration.html#cb102-10" tabindex="-1"></a><span class="co"># usfs_met_full &lt;- do.call(rbind, data_list)</span></span>
<span id="cb102-11"><a href="evapotranspiration.html#cb102-11" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb102-12"><a href="evapotranspiration.html#cb102-12" tabindex="-1"></a><span class="co"># # Read in daylight hours:</span></span>
<span id="cb102-13"><a href="evapotranspiration.html#cb102-13" tabindex="-1"></a><span class="co"># daylight&lt;- read.csv(&quot;daylight_hours.csv&quot;)</span></span></code></pre></div>
</div>
</div>
<div id="data-formatting" class="section level4 hasAnchor" number="12.3.1.3">
<h4><span class="header-section-number">12.3.1.3</span> Data formatting<a href="evapotranspiration.html#data-formatting" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We will model ET at daily timesteps. Note that all imported data is for different timesteps, units and measurements than what we need for analysis. It is common practice to manipulate the imported data and adjust it to align with our model functions. Ensuring the correct structure of the data can prevent potential issues later in the code</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="evapotranspiration.html#cb103-1" tabindex="-1"></a><span class="co"># # Let&#39;s start with met data. We need RHmax and RHmin, so we will choose the max and min of each day from the 10 minute intervals. </span></span>
<span id="cb103-2"><a href="evapotranspiration.html#cb103-2" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-3"><a href="evapotranspiration.html#cb103-3" tabindex="-1"></a><span class="co"># # Convert &#39;TIMESTAMP&#39; column to POSIXct type using lubridate</span></span>
<span id="cb103-4"><a href="evapotranspiration.html#cb103-4" tabindex="-1"></a><span class="co"># usfs_met_full$TIMESTAMP &lt;- mdy_hm(usfs_met_full$TIMESTAMP)</span></span>
<span id="cb103-5"><a href="evapotranspiration.html#cb103-5" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-6"><a href="evapotranspiration.html#cb103-6" tabindex="-1"></a><span class="co"># # Filter data for the desired water year (Oct 1, 2021 - Sep 30, 2022)</span></span>
<span id="cb103-7"><a href="evapotranspiration.html#cb103-7" tabindex="-1"></a><span class="co"># water_year_start &lt;- ymd(&quot;2021-10-01&quot;)</span></span>
<span id="cb103-8"><a href="evapotranspiration.html#cb103-8" tabindex="-1"></a><span class="co"># water_year_end &lt;- ymd(&quot;2022-09-30&quot;)</span></span>
<span id="cb103-9"><a href="evapotranspiration.html#cb103-9" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-10"><a href="evapotranspiration.html#cb103-10" tabindex="-1"></a><span class="co"># usfs_met &lt;- usfs_met_full %&gt;%</span></span>
<span id="cb103-11"><a href="evapotranspiration.html#cb103-11" tabindex="-1"></a><span class="co">#   filter(TIMESTAMP &gt;= water_year_start &amp; TIMESTAMP &lt;= water_year_end)</span></span>
<span id="cb103-12"><a href="evapotranspiration.html#cb103-12" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb103-13"><a href="evapotranspiration.html#cb103-13" tabindex="-1"></a><span class="co"># # Aggregate data to daily intervals</span></span>
<span id="cb103-14"><a href="evapotranspiration.html#cb103-14" tabindex="-1"></a><span class="co"># usfs_met_rh &lt;- usfs_met %&gt;%</span></span>
<span id="cb103-15"><a href="evapotranspiration.html#cb103-15" tabindex="-1"></a><span class="co">#   group_by(Date = as.Date(TIMESTAMP)) %&gt;%</span></span>
<span id="cb103-16"><a href="evapotranspiration.html#cb103-16" tabindex="-1"></a><span class="co">#   summarise(Tmean = mean(AirT..C.),</span></span>
<span id="cb103-17"><a href="evapotranspiration.html#cb103-17" tabindex="-1"></a><span class="co">#             Tmax = max(AirT..C.),</span></span>
<span id="cb103-18"><a href="evapotranspiration.html#cb103-18" tabindex="-1"></a><span class="co">#             Tmin = min(AirT..C.),</span></span>
<span id="cb103-19"><a href="evapotranspiration.html#cb103-19" tabindex="-1"></a><span class="co">#             RHmean = mean(RH....),</span></span>
<span id="cb103-20"><a href="evapotranspiration.html#cb103-20" tabindex="-1"></a><span class="co">#             RHmax = max(RH....),</span></span>
<span id="cb103-21"><a href="evapotranspiration.html#cb103-21" tabindex="-1"></a><span class="co">#             RHmin = min(RH....)) %&gt;%</span></span>
<span id="cb103-22"><a href="evapotranspiration.html#cb103-22" tabindex="-1"></a><span class="co">#   ungroup()</span></span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="evapotranspiration.html#cb104-1" tabindex="-1"></a><span class="co"># # Let&#39;s add daylight hours to the met dataframe</span></span>
<span id="cb104-2"><a href="evapotranspiration.html#cb104-2" tabindex="-1"></a><span class="co"># # daylight contains month and day, lets format month and day for usfs_met so we can merge the dataframes:</span></span>
<span id="cb104-3"><a href="evapotranspiration.html#cb104-3" tabindex="-1"></a><span class="co"># usfs_met_rh$month &lt;- format(usfs_met_rh$Date, &quot;%m&quot;)</span></span>
<span id="cb104-4"><a href="evapotranspiration.html#cb104-4" tabindex="-1"></a><span class="co"># usfs_met_rh$day &lt;- format(usfs_met_rh$Date, &quot;%d&quot;)</span></span>
<span id="cb104-5"><a href="evapotranspiration.html#cb104-5" tabindex="-1"></a><span class="co"># # Convert &quot;month&quot; and &quot;day&quot; columns in daylight to character</span></span>
<span id="cb104-6"><a href="evapotranspiration.html#cb104-6" tabindex="-1"></a><span class="co"># daylight$month &lt;- sprintf(&quot;%02d&quot;, daylight$month)</span></span>
<span id="cb104-7"><a href="evapotranspiration.html#cb104-7" tabindex="-1"></a><span class="co"># daylight$day &lt;- sprintf(&quot;%02d&quot;, daylight$day)</span></span>
<span id="cb104-8"><a href="evapotranspiration.html#cb104-8" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb104-9"><a href="evapotranspiration.html#cb104-9" tabindex="-1"></a><span class="co"># # Now, merge the &quot;N&quot; column from daylight into usfs_met_rh based on the month and day columns</span></span>
<span id="cb104-10"><a href="evapotranspiration.html#cb104-10" tabindex="-1"></a><span class="co"># usfs_met_rh &lt;- merge(usfs_met_rh, daylight[, c(&quot;month&quot;, &quot;day&quot;, &quot;N&quot;)], by = c(&quot;month&quot;, &quot;day&quot;), all.x = TRUE)</span></span>
<span id="cb104-11"><a href="evapotranspiration.html#cb104-11" tabindex="-1"></a><span class="co"># usfs_met_rh$n &lt;- usfs_met_rh$N*12</span></span>
<span id="cb104-12"><a href="evapotranspiration.html#cb104-12" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb104-13"><a href="evapotranspiration.html#cb104-13" tabindex="-1"></a><span class="co"># # Reorder merged data based on the &quot;Date&quot; column</span></span>
<span id="cb104-14"><a href="evapotranspiration.html#cb104-14" tabindex="-1"></a><span class="co"># usfs_met_rh &lt;- usfs_met_rh %&gt;% arrange(Date)</span></span>
<span id="cb104-15"><a href="evapotranspiration.html#cb104-15" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb104-16"><a href="evapotranspiration.html#cb104-16" tabindex="-1"></a><span class="co"># # Check the head of merged data to verify the reordering</span></span>
<span id="cb104-17"><a href="evapotranspiration.html#cb104-17" tabindex="-1"></a><span class="co"># head(usfs_met_rh)</span></span></code></pre></div>
<p>Now we have the RHmax and RHmin values that we will need for our ET models</p>
<div id="precipitation" class="section level5 hasAnchor" number="12.3.1.3.1">
<h5><span class="header-section-number">12.3.1.3.1</span> Precipitation<a href="evapotranspiration.html#precipitation" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To add a layer of checks we will also check precipitation totals for the watershed from our met data. This dataframe also provides cumulative precipitation, though the accumulation begins on January 1. Therefore we will need to calculate daily precipitation for each day of the water year and generate a new cumulative value.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="evapotranspiration.html#cb105-1" tabindex="-1"></a><span class="co"># # Calculate daily precipitation by subtracting consecutive values</span></span>
<span id="cb105-2"><a href="evapotranspiration.html#cb105-2" tabindex="-1"></a><span class="co"># usfs_met &lt;- usfs_met %&gt;%</span></span>
<span id="cb105-3"><a href="evapotranspiration.html#cb105-3" tabindex="-1"></a><span class="co">#   mutate(daily_ppt_mm = Cumulative_ppt..mm. - lag(Cumulative_ppt..mm., default = 0))</span></span>
<span id="cb105-4"><a href="evapotranspiration.html#cb105-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-5"><a href="evapotranspiration.html#cb105-5" tabindex="-1"></a><span class="co"># # Set the first row of daily_ppt_mm to 0</span></span>
<span id="cb105-6"><a href="evapotranspiration.html#cb105-6" tabindex="-1"></a><span class="co"># usfs_met$daily_ppt_mm[1] &lt;- 0</span></span>
<span id="cb105-7"><a href="evapotranspiration.html#cb105-7" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-8"><a href="evapotranspiration.html#cb105-8" tabindex="-1"></a><span class="co"># # reset cumulative value calculated from calendar year on Jan 1</span></span>
<span id="cb105-9"><a href="evapotranspiration.html#cb105-9" tabindex="-1"></a><span class="co"># usfs_met &lt;- usfs_met %&gt;%</span></span>
<span id="cb105-10"><a href="evapotranspiration.html#cb105-10" tabindex="-1"></a><span class="co">#   mutate(daily_ppt_mm = if_else(TIMESTAMP == ymd_hms(&quot;2022-01-01 00:00:00&quot;), 0, daily_ppt_mm))</span></span>
<span id="cb105-11"><a href="evapotranspiration.html#cb105-11" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-12"><a href="evapotranspiration.html#cb105-12" tabindex="-1"></a><span class="co"># # Sum daily precipitation for the water year</span></span>
<span id="cb105-13"><a href="evapotranspiration.html#cb105-13" tabindex="-1"></a><span class="co"># cumulative_ppt_2022 &lt;- sum(usfs_met$daily_ppt_mm, na.rm = TRUE)</span></span></code></pre></div>
<p>This was a lot of work to save one value.</p>
</div>
</div>
<div id="pseudocode" class="section level4 hasAnchor" number="12.3.1.4">
<h4><span class="header-section-number">12.3.1.4</span> Pseudocode<a href="evapotranspiration.html#pseudocode" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Often when writing code, it is necessary to first write ‘pseudocode’. This allows us to think about workflow before writing scripts involves planning and structuring the logic of a script. Psuedocode is usually mixture of natural language and code-like constructs (e.g., ‘I’ll use ’merge’ or ‘ggplot’ to…’) that serves as a blueprint for our script before we dive into specific programming language syntax. Then we can develop our code by filling in the programming language as needed.</p>
<p><strong>Q1.</strong> (2pnts) In you own words, what did we do at each step in the above chunk and what is cumulative_ppt_2022. Why do we want to know this?</p>
<p>ANSWER:</p>
<div id="discharge-data" class="section level5 hasAnchor" number="12.3.1.4.1">
<h5><span class="header-section-number">12.3.1.4.1</span> Discharge data<a href="evapotranspiration.html#discharge-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Our next step will be to import and format discharge data collected from the weir at Fool Creek. Again, data collection starts on April 20th this year. To estimate discharge between Sept 31 of the previous year and April 20th of 2022, we will assume daily discharge between these dates is the mean of the discharge values from each of these dates.</p>
<p><strong>Q2</strong> (3pnts) Write pseudocode in a stepwise fashion to describe the workflow that will need to happen to estimate the total volume of water in mm/watershed area for 2022 lost to stream discharge. Consider that the units provided by USFS are in cubic feet/second (cfs).</p>
<p>ANSWER:
1. Import dataframe
2. …</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="evapotranspiration.html#cb106-1" tabindex="-1"></a><span class="co"># # Import weir data</span></span>
<span id="cb106-2"><a href="evapotranspiration.html#cb106-2" tabindex="-1"></a><span class="co"># lfc_weir&lt;- read.csv(&quot;LFC_weir_2022.csv&quot;)</span></span>
<span id="cb106-3"><a href="evapotranspiration.html#cb106-3" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-4"><a href="evapotranspiration.html#cb106-4" tabindex="-1"></a><span class="co"># # Convert &#39;TIMESTAMP&#39; column to POSIXct type using lubridate</span></span>
<span id="cb106-5"><a href="evapotranspiration.html#cb106-5" tabindex="-1"></a><span class="co"># lfc_weir$TIMESTAMP &lt;- mdy_hm(lfc_weir$TIMESTAMP)</span></span>
<span id="cb106-6"><a href="evapotranspiration.html#cb106-6" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-7"><a href="evapotranspiration.html#cb106-7" tabindex="-1"></a><span class="co"># # Conversion factor from cfs to cubic millimeters per second</span></span>
<span id="cb106-8"><a href="evapotranspiration.html#cb106-8" tabindex="-1"></a><span class="co"># cfs_to_mm3_per_sec &lt;- 28316846.6 </span></span>
<span id="cb106-9"><a href="evapotranspiration.html#cb106-9" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-10"><a href="evapotranspiration.html#cb106-10" tabindex="-1"></a><span class="co"># # Convert cfs to cubic millimeters per day</span></span>
<span id="cb106-11"><a href="evapotranspiration.html#cb106-11" tabindex="-1"></a><span class="co"># lfc_weir &lt;- lfc_weir %&gt;%</span></span>
<span id="cb106-12"><a href="evapotranspiration.html#cb106-12" tabindex="-1"></a><span class="co">#   group_by(Date = as.Date(TIMESTAMP)) %&gt;%</span></span>
<span id="cb106-13"><a href="evapotranspiration.html#cb106-13" tabindex="-1"></a><span class="co">#   summarise(</span></span>
<span id="cb106-14"><a href="evapotranspiration.html#cb106-14" tabindex="-1"></a><span class="co">#     Q_daily_cfs = mean(Q..cfs.),</span></span>
<span id="cb106-15"><a href="evapotranspiration.html#cb106-15" tabindex="-1"></a><span class="co">#     Q_daily_mm3_per_day = mean(Q..cfs.) * cfs_to_mm3_per_sec * 86400  # 86400 seconds in a day</span></span>
<span id="cb106-16"><a href="evapotranspiration.html#cb106-16" tabindex="-1"></a><span class="co">#   ) %&gt;%</span></span>
<span id="cb106-17"><a href="evapotranspiration.html#cb106-17" tabindex="-1"></a><span class="co">#   ungroup()</span></span>
<span id="cb106-18"><a href="evapotranspiration.html#cb106-18" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-19"><a href="evapotranspiration.html#cb106-19" tabindex="-1"></a><span class="co"># # Watershed area in square millimeters</span></span>
<span id="cb106-20"><a href="evapotranspiration.html#cb106-20" tabindex="-1"></a><span class="co"># watershed_area_mm2 &lt;- 2.69e6 * 1e6  # Convert km^2 to square millimeters</span></span>
<span id="cb106-21"><a href="evapotranspiration.html#cb106-21" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-22"><a href="evapotranspiration.html#cb106-22" tabindex="-1"></a><span class="co"># # Convert flow rate from cubic millimeters per day to millimeters per day per unit area</span></span>
<span id="cb106-23"><a href="evapotranspiration.html#cb106-23" tabindex="-1"></a><span class="co"># lfc_weir &lt;- lfc_weir %&gt;%</span></span>
<span id="cb106-24"><a href="evapotranspiration.html#cb106-24" tabindex="-1"></a><span class="co">#   mutate(Q_daily_mm_per_day_per_area = Q_daily_mm3_per_day / watershed_area_mm2)</span></span>
<span id="cb106-25"><a href="evapotranspiration.html#cb106-25" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-26"><a href="evapotranspiration.html#cb106-26" tabindex="-1"></a><span class="co"># meanwinterQ &lt;- sum(lfc_weir$Q_daily_mm_per_day_per_area[lfc_weir$Date == as.Date(&quot;2022-09-30&quot;)],lfc_weir$Q_daily_mm_per_day_per_area[1])/2</span></span>
<span id="cb106-27"><a href="evapotranspiration.html#cb106-27" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-28"><a href="evapotranspiration.html#cb106-28" tabindex="-1"></a><span class="co"># # Calculate the difference in days from the end of the wateryear to the resumption of data collection</span></span>
<span id="cb106-29"><a href="evapotranspiration.html#cb106-29" tabindex="-1"></a><span class="co"># start_date &lt;- as.Date(&quot;2021-09-30&quot;)</span></span>
<span id="cb106-30"><a href="evapotranspiration.html#cb106-30" tabindex="-1"></a><span class="co"># end_date &lt;- as.Date(&quot;2022-04-20&quot;)</span></span>
<span id="cb106-31"><a href="evapotranspiration.html#cb106-31" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-32"><a href="evapotranspiration.html#cb106-32" tabindex="-1"></a><span class="co"># days_difference &lt;- difftime(end_date, start_date, units = &quot;days&quot;)</span></span>
<span id="cb106-33"><a href="evapotranspiration.html#cb106-33" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-34"><a href="evapotranspiration.html#cb106-34" tabindex="-1"></a><span class="co"># # Convert the result to numeric</span></span>
<span id="cb106-35"><a href="evapotranspiration.html#cb106-35" tabindex="-1"></a><span class="co"># days_difference &lt;- as.numeric(days_difference)</span></span>
<span id="cb106-36"><a href="evapotranspiration.html#cb106-36" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb106-37"><a href="evapotranspiration.html#cb106-37" tabindex="-1"></a><span class="co"># Qsum2022 &lt;-sum(meanwinterQ *days_difference, sum(lfc_weir$Q_daily_mm_per_day_per_area))</span></span></code></pre></div>
</div>
<div id="evapotranspiration-data" class="section level5 hasAnchor" number="12.3.1.4.2">
<h5><span class="header-section-number">12.3.1.4.2</span> Evapotranspiration data<a href="evapotranspiration.html#evapotranspiration-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Import and transform ET data. <br>
Note that ET data is in mmol/m2/s. We want to convert this to mm/day. <br>
Eddy covariance data collected from towers represents the exchange of gases, including water vapor, between the atmosphere and the land surface within a certain area known as the “footprint.” This footprint area is not fixed; it changes in size and shape depending on factors like wind direction, thermal stability, and measurement height. Typically, it has a gradual border, meaning that the influence of the tower measurements extends beyond its immediate vicinity.</p>
<p>For our specific tower data, we’ve estimated the mean flux area, or footprint area, to be approximately 0.4 square kilometers. However, when estimating the total evapotranspiration (ET) for our entire watershed, we need to extrapolate the ET measured by the tower to cover the entire watershed area. This extrapolation involves scaling up the measurements from the tower footprint to the larger area of the watershed to get a more comprehensive understanding of water vapor exchange over the entire region.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="evapotranspiration.html#cb107-1" tabindex="-1"></a><span class="co"># # Import ET data</span></span>
<span id="cb107-2"><a href="evapotranspiration.html#cb107-2" tabindex="-1"></a><span class="co"># usfs_et &lt;- read.csv(&quot;US_FEF_ET.csv&quot;)</span></span>
<span id="cb107-3"><a href="evapotranspiration.html#cb107-3" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb107-4"><a href="evapotranspiration.html#cb107-4" tabindex="-1"></a><span class="co"># # The ET data contains negative values. ET is not negative, we are going to convert these to NA. This may not always be an ideal solution. It is a good idea to talk to the tower maintainer or consult metadata to check the source of negative values:</span></span>
<span id="cb107-5"><a href="evapotranspiration.html#cb107-5" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb107-6"><a href="evapotranspiration.html#cb107-6" tabindex="-1"></a><span class="co"># # Replace negative values in &#39;ET&#39; column with 0 (this is the recommended course of action by our USFS maintainer)</span></span>
<span id="cb107-7"><a href="evapotranspiration.html#cb107-7" tabindex="-1"></a><span class="co"># usfs_et$ET_mmol.m2.s[usfs_et$ET_mmol.m2.s &lt; 0] &lt;- 0.0</span></span>
<span id="cb107-8"><a href="evapotranspiration.html#cb107-8" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb107-9"><a href="evapotranspiration.html#cb107-9" tabindex="-1"></a><span class="co"># # Define function to convert mmol/m2/s to mm/30 min interval</span></span>
<span id="cb107-10"><a href="evapotranspiration.html#cb107-10" tabindex="-1"></a><span class="co"># mmol_to_mm &lt;- function(x) {</span></span>
<span id="cb107-11"><a href="evapotranspiration.html#cb107-11" tabindex="-1"></a><span class="co">#   return((x * 1.5552) / 48)</span></span>
<span id="cb107-12"><a href="evapotranspiration.html#cb107-12" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb107-13"><a href="evapotranspiration.html#cb107-13" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb107-14"><a href="evapotranspiration.html#cb107-14" tabindex="-1"></a><span class="co"># # Apply function to &#39;ET_mmol.m2.s&#39; column and create new column &#39;ET_mm&#39;</span></span>
<span id="cb107-15"><a href="evapotranspiration.html#cb107-15" tabindex="-1"></a><span class="co"># usfs_et$ET_mm &lt;- sapply(usfs_et$ET_mmol.m2.s, mmol_to_mm)</span></span>
<span id="cb107-16"><a href="evapotranspiration.html#cb107-16" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb107-17"><a href="evapotranspiration.html#cb107-17" tabindex="-1"></a><span class="co"># # Now let&#39;s aggregate the 30min timesteps to daily means:</span></span>
<span id="cb107-18"><a href="evapotranspiration.html#cb107-18" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb107-19"><a href="evapotranspiration.html#cb107-19" tabindex="-1"></a><span class="co"># # Convert &#39;datetime&#39; column to POSIXct type</span></span>
<span id="cb107-20"><a href="evapotranspiration.html#cb107-20" tabindex="-1"></a><span class="co"># usfs_et$datetime &lt;- mdy_hm(usfs_et$datetime)</span></span>
<span id="cb107-21"><a href="evapotranspiration.html#cb107-21" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb107-22"><a href="evapotranspiration.html#cb107-22" tabindex="-1"></a><span class="co"># # Extract date from datetime</span></span>
<span id="cb107-23"><a href="evapotranspiration.html#cb107-23" tabindex="-1"></a><span class="co"># usfs_et$date &lt;- as.Date(usfs_et$datetime)</span></span>
<span id="cb107-24"><a href="evapotranspiration.html#cb107-24" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb107-25"><a href="evapotranspiration.html#cb107-25" tabindex="-1"></a><span class="co"># # Group by date and calculate sum of &#39;ET_mm&#39;</span></span>
<span id="cb107-26"><a href="evapotranspiration.html#cb107-26" tabindex="-1"></a><span class="co"># usfs_et_daily &lt;- usfs_et %&gt;%</span></span>
<span id="cb107-27"><a href="evapotranspiration.html#cb107-27" tabindex="-1"></a><span class="co">#   group_by(date) %&gt;%</span></span>
<span id="cb107-28"><a href="evapotranspiration.html#cb107-28" tabindex="-1"></a><span class="co">#   summarise(ET_mm = sum(ET_mm))</span></span>
<span id="cb107-29"><a href="evapotranspiration.html#cb107-29" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb107-30"><a href="evapotranspiration.html#cb107-30" tabindex="-1"></a><span class="co"># # Account for covariance footprint and watershed area:</span></span>
<span id="cb107-31"><a href="evapotranspiration.html#cb107-31" tabindex="-1"></a><span class="co"># usfs_et_daily$ws_et &lt;-  usfs_et_daily$ET_mm * 0.35 * 2.69</span></span>
<span id="cb107-32"><a href="evapotranspiration.html#cb107-32" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb107-33"><a href="evapotranspiration.html#cb107-33" tabindex="-1"></a><span class="co"># usfs_et_daily$date &lt;- as.Date(usfs_et_daily$date)</span></span>
<span id="cb107-34"><a href="evapotranspiration.html#cb107-34" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb107-35"><a href="evapotranspiration.html#cb107-35" tabindex="-1"></a><span class="co"># subset_data &lt;- subset(usfs_et_daily, date &gt;= as.Date(&quot;2021-10-01&quot;) &amp; date &lt;= as.Date(&quot;2022-09-30&quot;))</span></span>
<span id="cb107-36"><a href="evapotranspiration.html#cb107-36" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb107-37"><a href="evapotranspiration.html#cb107-37" tabindex="-1"></a><span class="co"># # Finally, calculate the sum of &#39;ws_et&#39; for the subsetted data</span></span>
<span id="cb107-38"><a href="evapotranspiration.html#cb107-38" tabindex="-1"></a><span class="co"># ws_et_2022 &lt;- sum(subset_data$ws_et)</span></span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="evapotranspiration.html#cb108-1" tabindex="-1"></a><span class="co"># Hbalance &lt;- cumulative_ppt_2022 - ws_et_2022 - Qsum2022</span></span>
<span id="cb108-2"><a href="evapotranspiration.html#cb108-2" tabindex="-1"></a><span class="co"># print(Hbalance)</span></span></code></pre></div>
<p>This appears to be a fairly well balanced water budget, especially consdering that we have made some estimates along the way. Let’s see how this ET data compares to modeled data.</p>
</div>
</div>
</div>
<div id="the-priestly-taylor-method-actual-evapotranspiration" class="section level3 hasAnchor" number="12.3.2">
<h3><span class="header-section-number">12.3.2</span> <a href="https://search.r-project.org/CRAN/refmans/Evapotranspiration/html/ET.PriestleyTaylor.html">The Priestly Taylor method</a> (actual evapotranspiration)<a href="evapotranspiration.html#the-priestly-taylor-method-actual-evapotranspiration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Priestley-Taylor method is a semi-empirical model that estimates potential evapotranspiration as a function of net radiation. This method requires a list which contains:<br> (climate variables) required by Priestley-Taylor formulation:
Tmax, Tmin (degree Celcius), RHmax, RHmin (percent), Rs (Megajoules per sqm) or n (hour). <br>
We have measurements of relative humidity (RH) data from within our watershed meteorological station. However, RH data can be found through many sources providing local weather data. <br>
n refers to the number of sunshine hours.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="evapotranspiration.html#cb109-1" tabindex="-1"></a><span class="co"># # Transform data to a list for the function </span></span>
<span id="cb109-2"><a href="evapotranspiration.html#cb109-2" tabindex="-1"></a><span class="co"># data_list &lt;- list(</span></span>
<span id="cb109-3"><a href="evapotranspiration.html#cb109-3" tabindex="-1"></a><span class="co">#   Date.daily = usfs_met_rh$Date,  # Assuming this is your &quot;Date&quot; column</span></span>
<span id="cb109-4"><a href="evapotranspiration.html#cb109-4" tabindex="-1"></a><span class="co">#   Date.monthly = as.yearmon(unique(usfs_met_rh$Date)),</span></span>
<span id="cb109-5"><a href="evapotranspiration.html#cb109-5" tabindex="-1"></a><span class="co">#   J = zoo::zoo(c(272:365,1:271), usfs_met_rh$Date),</span></span>
<span id="cb109-6"><a href="evapotranspiration.html#cb109-6" tabindex="-1"></a><span class="co">#   Tmax = zoo::zoo(usfs_met_rh$Tmax, usfs_met_rh$Date),</span></span>
<span id="cb109-7"><a href="evapotranspiration.html#cb109-7" tabindex="-1"></a><span class="co">#   Tmin = zoo::zoo(usfs_met_rh$Tmin, usfs_met_rh$Date),</span></span>
<span id="cb109-8"><a href="evapotranspiration.html#cb109-8" tabindex="-1"></a><span class="co">#   RHmax = zoo::zoo(usfs_met_rh$RHmax, usfs_met_rh$Date),</span></span>
<span id="cb109-9"><a href="evapotranspiration.html#cb109-9" tabindex="-1"></a><span class="co">#   RHmin = zoo::zoo(usfs_met_rh$RHmin, usfs_met_rh$Date),</span></span>
<span id="cb109-10"><a href="evapotranspiration.html#cb109-10" tabindex="-1"></a><span class="co">#   n = zoo::zoo(usfs_met_rh$n, usfs_met_rh$Date)</span></span>
<span id="cb109-11"><a href="evapotranspiration.html#cb109-11" tabindex="-1"></a><span class="co"># )</span></span></code></pre></div>
<p>Evapotranspiration comes with a list physical ‘constants’, but we want to replace important constants with data specific to our cite.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="evapotranspiration.html#cb110-1" tabindex="-1"></a><span class="co"># data(&quot;constants&quot;)</span></span>
<span id="cb110-2"><a href="evapotranspiration.html#cb110-2" tabindex="-1"></a><span class="co"># constants$Elev &lt;- 2900</span></span>
<span id="cb110-3"><a href="evapotranspiration.html#cb110-3" tabindex="-1"></a><span class="co"># constants$lat &lt;- 39.89</span></span>
<span id="cb110-4"><a href="evapotranspiration.html#cb110-4" tabindex="-1"></a><span class="co"># constants$lat_rad &lt;- 0.6962</span></span></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="evapotranspiration.html#cb111-1" tabindex="-1"></a><span class="co"># # Lets plot the modeled output: </span></span>
<span id="cb111-2"><a href="evapotranspiration.html#cb111-2" tabindex="-1"></a><span class="co"># plot(outputPT$ET.Daily, main = &quot;ET Daily Data&quot;, xlab = &quot;Date&quot;, ylab = &quot;ET&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="evapotranspiration.html#cb112-1" tabindex="-1"></a><span class="co"># # Lets plot the modeled output: </span></span>
<span id="cb112-2"><a href="evapotranspiration.html#cb112-2" tabindex="-1"></a><span class="co"># # Plot the first zoo object</span></span>
<span id="cb112-3"><a href="evapotranspiration.html#cb112-3" tabindex="-1"></a><span class="co"># plot(outputH$ET.Daily, main = &quot;ET Daily Data&quot;, xlab = &quot;Date&quot;, ylab = &quot;ET&quot;, col = &quot;blue&quot;)</span></span>
<span id="cb112-4"><a href="evapotranspiration.html#cb112-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb112-5"><a href="evapotranspiration.html#cb112-5" tabindex="-1"></a><span class="co"># # Add the second zoo object to the same plot</span></span>
<span id="cb112-6"><a href="evapotranspiration.html#cb112-6" tabindex="-1"></a><span class="co"># lines(outputPT$ET.Daily, col = &quot;red&quot;)</span></span>
<span id="cb112-7"><a href="evapotranspiration.html#cb112-7" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb112-8"><a href="evapotranspiration.html#cb112-8" tabindex="-1"></a><span class="co"># # Add a legend</span></span>
<span id="cb112-9"><a href="evapotranspiration.html#cb112-9" tabindex="-1"></a><span class="co"># legend(&quot;topright&quot;, legend = c(&quot;H Method&quot;, &quot;PT Method&quot;), col = c(&quot;blue&quot;, &quot;red&quot;), lty = 1)</span></span></code></pre></div>
<p>Recall that each of these are estimates of potential ET.
Crop coefficients (Kc values) for specific tree species like those found in the Fraser Experimental Forest (lodgepole pine or Englemann spruce) may not be as readily available as they are for agricultural crops. However, you may be able to find some guidance in scientific literature or forestry publications. From what we have found, Kc estimates for lodgepole pine forests can be between 0.4 and 0.8. These values may vary depending on factors such as climate, soil type, elevation, and other site-specific factors. Our own estimates using water balance data from dates that correspond with the eddy flux tower data suggest seasonal fluctuations, with a mean of 0.55.</p>
<p>AET = PET * Kc</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="evapotranspiration.html#cb113-1" tabindex="-1"></a><span class="co"># kc = 0.55</span></span>
<span id="cb113-2"><a href="evapotranspiration.html#cb113-2" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-3"><a href="evapotranspiration.html#cb113-3" tabindex="-1"></a><span class="co"># # Convert zoo series to dataframe</span></span>
<span id="cb113-4"><a href="evapotranspiration.html#cb113-4" tabindex="-1"></a><span class="co"># outputPT_df &lt;- broom::tidy(outputPT$ET.Daily)</span></span>
<span id="cb113-5"><a href="evapotranspiration.html#cb113-5" tabindex="-1"></a><span class="co"># outputH_df &lt;- broom::tidy(outputH$ET.Daily)</span></span>
<span id="cb113-6"><a href="evapotranspiration.html#cb113-6" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb113-7"><a href="evapotranspiration.html#cb113-7" tabindex="-1"></a><span class="co"># outputPT_df$aet_pt &lt;- outputPT_df$value * kc</span></span>
<span id="cb113-8"><a href="evapotranspiration.html#cb113-8" tabindex="-1"></a><span class="co"># outputH_df$aet_pt &lt;- outputH_df$value * kc</span></span></code></pre></div>
<p>Let’s plot the two modeled ET timeseries with the eddy covaraince tower data.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="evapotranspiration.html#cb114-1" tabindex="-1"></a><span class="co"># # Plot</span></span>
<span id="cb114-2"><a href="evapotranspiration.html#cb114-2" tabindex="-1"></a><span class="co"># ggplot() +</span></span>
<span id="cb114-3"><a href="evapotranspiration.html#cb114-3" tabindex="-1"></a><span class="co">#   geom_line(data = subset_data, aes(x = date, y = ET_mm, color = &quot;ET_mm&quot;)) +</span></span>
<span id="cb114-4"><a href="evapotranspiration.html#cb114-4" tabindex="-1"></a><span class="co">#   geom_line(data = outputH_df, aes(x = index, y = aet_pt, color = &quot;H Method&quot;)) +</span></span>
<span id="cb114-5"><a href="evapotranspiration.html#cb114-5" tabindex="-1"></a><span class="co">#   geom_line(data = outputPT_df, aes(x = index, y = aet_pt, color = &quot;PT Method&quot;)) +</span></span>
<span id="cb114-6"><a href="evapotranspiration.html#cb114-6" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb114-7"><a href="evapotranspiration.html#cb114-7" tabindex="-1"></a><span class="co">#   labs(title = &quot;Comparison of AET_PT from Different Methods and ET_mm&quot;,</span></span>
<span id="cb114-8"><a href="evapotranspiration.html#cb114-8" tabindex="-1"></a><span class="co">#        x = &quot;Date&quot;,</span></span>
<span id="cb114-9"><a href="evapotranspiration.html#cb114-9" tabindex="-1"></a><span class="co">#        y = &quot;AET_PT / ET_mm&quot;,</span></span>
<span id="cb114-10"><a href="evapotranspiration.html#cb114-10" tabindex="-1"></a><span class="co">#        color = &quot;Method&quot;) +</span></span>
<span id="cb114-11"><a href="evapotranspiration.html#cb114-11" tabindex="-1"></a><span class="co">#   scale_color_manual(values = c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;)) +</span></span>
<span id="cb114-12"><a href="evapotranspiration.html#cb114-12" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span></code></pre></div>
<p><strong>Q3</strong>. (4pnts) Consider the two evapotranspiration (ET) models we have generated, one consistently underestimates ET, while the other consistently overestimates summer values and underestimates winter values. Consider cosystem specificity in modeling. Why do you think these two methods generate such different estimates? What ecosystem-specific factors might contribute to the discrepancies between models?</p>
<p>ANSWER:</p>
<p><strong>Q4</strong> (3pnts) Let’s assume we do not have eddy covariance tower data for this time period, but you have the provided discharge and precipitation measurements. Which model would you choose to estimate an annual ET sum and why?</p>
<p>ANSWER:</p>
<p><strong>Q5</strong> (3pnts) In our modeling script, while our main objective was to estimate evapotranspiration (ET), which specific aspect required the most labor and attention to detail? Reflect on the tasks involved in data preparation, cleaning, and formatting. How did these preliminary steps impact the overall modeling process?</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dem-processing.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tpcovino/lres_546_bookdown/edit/main/12_evapotranspiration.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/tpcovino/lres_546_bookdown/blob/main/12_evapotranspiration.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
